<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows 95 - GitHub Explorer</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* --- CSS Variables --- */
        :root {
            /* Windows 95 Color Palette */
            --win95-bg: #008080; /* Desktop teal */
            --win95-window-bg: #c0c0c0; /* Window silver */
            --win95-darker: #808080;
            --win95-darkest: #404040;
            --win95-light: #d4d0c8; /* Classic Win95 surface */
            --win95-lighter: #ffffff;
            --win95-text: #000000;
            --win95-blue: #000080; /* Title bar */
            --win95-blue-highlight: #0000ff;
            --win95-title-active: #000080;
            --win95-title-active-text: #ffffff;
            --win95-title-inactive: #808080;
            --win95-title-inactive-text: #d4d0c8;
            --win95-menu-bg: #d4d0c8;
            --win95-menu-text: #000000;
            --win95-menu-hover-bg: #000080;
            --win95-menu-hover-text: #ffffff;
            /* Minesweeper colors */
            --minesweeper-bg: #c0c0c0;
            --minesweeper-revealed: #c0c0c0;
            --minesweeper-1: #0000ff; /* Blue */
            --minesweeper-2: #008000; /* Green */
            --minesweeper-3: #ff0000; /* Red */
            --minesweeper-4: #000080; /* Dark Blue */
            --minesweeper-5: #800000; /* Dark Red */
            --minesweeper-6: #008080; /* Teal */
            --minesweeper-7: #000000; /* Black */
            --minesweeper-8: #808080; /* Gray */
        }
        
        /* --- Reset & Basic Styles --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'MS Sans Serif', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            user-select: none;
        }
        
        html, body {
            background-color: var(--win95-bg);
            color: var(--win95-text);
            font-size: 11px;
            line-height: 1.4;
            overflow: hidden;
            height: 100%;
            margin: 0;
            padding: 0;
        }
        
        body {
            padding: 0;
            min-height: 100vh;
            cursor: default;
        }

        /* --- Windows 95 Button Style --- */
        .win95-button {
            padding: 4px 8px;
            background-color: var(--win95-light);
            border-width: 2px;
            border-style: solid;
            border-color: var(--win95-lighter) var(--win95-darker) var(--win95-darker) var(--win95-lighter);
            color: var(--win95-text);
            font-size: 11px;
            font-weight: normal;
            cursor: pointer;
            display: inline-block;
            text-align: center;
            position: relative;
            outline: none;
            font-family: 'MS Sans Serif', Arial, sans-serif;
            margin: 2px;
        }
        
        .win95-button:active {
            border-color: var(--win95-darker) var(--win95-lighter) var(--win95-lighter) var(--win95-darker);
            padding: 5px 7px 3px 9px;
        }
        
        .win95-button:focus {
            outline: 1px dotted #000;
            outline-offset: -4px;
        }

        /* --- Windows 95 Window Style --- */
        .win95-window {
            border: 2px solid;
            border-color: var(--win95-lighter) var(--win95-darker) var(--win95-darker) var(--win95-lighter);
            background-color: var(--win95-light);
            position: absolute;
            resize: both;
            overflow: hidden;
            box-shadow: 1px 1px 0 var(--win95-darkest);
            min-width: 200px;
            min-height: 150px;
            z-index: 10;
        }
        
        .win95-title-bar {
            background-color: var(--win95-title-active);
            color: var(--win95-title-active-text);
            padding: 2px 3px 3px 3px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            user-select: none;
            height: 18px;
        }
        
        .win95-title-bar.inactive {
            background-color: var(--win95-title-inactive);
            color: var(--win95-title-inactive-text);
        }
        
        .win95-title {
            padding-left: 3px;
            font-size: 11px;
            font-weight: bold;
            display: flex;
            align-items: center;
        }
        
        .win95-title-icon {
            width: 16px;
            height: 16px;
            margin-right: 4px;
            display: inline-block;
        }
        
        .win95-buttons {
            display: flex;
        }
        
        .win95-window-button {
            width: 16px;
            height: 14px;
            margin-left: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9px;
            border-width: 1px;
            border-style: solid;
            border-color: var(--win95-lighter) var(--win95-darker) var(--win95-darker) var(--win95-lighter);
            background-color: var(--win95-light);
            color: var(--win95-text);
            cursor: pointer;
            font-family: "Courier New", monospace;
        }
        
        .win95-window-button:active {
            border-color: var(--win95-darker) var(--win95-lighter) var(--win95-lighter) var(--win95-darker);
        }
        
        .win95-window-content {
            padding: 1px;
            overflow: auto;
            border: 1px solid var(--win95-darkest);
            border-top: none;
            background-color: var(--win95-light);
            position: absolute;
            top: 18px;
            left: 0;
            right: 0;
            bottom: 20px;
        }
        
        .win95-status-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 20px;
            border-top: 1px solid var(--win95-darkest);
            background-color: var(--win95-light);
            padding: 2px 5px;
            display: flex;
            align-items: center;
            font-size: 11px;
        }
        
        .win95-status-section {
            padding: 0 5px;
            border-right: 1px solid var(--win95-darker);
            border-left: 1px solid var(--win95-lighter);
            min-height: 14px;
            flex: 1;
            display: flex;
            align-items: center;
        }
        
        .win95-status-section:first-child {
            border-left: none;
        }
        
        .win95-status-section:last-child {
            border-right: none;
            flex: 0;
            padding-right: 0;
        }

        /* --- Menu Bar --- */
        .win95-menu-bar {
            background-color: var(--win95-light);
            border-bottom: 1px solid var(--win95-darker);
            display: flex;
            padding: 1px;
        }
        
        .win95-menu-item {
            padding: 2px 7px;
            cursor: pointer;
            position: relative;
            color: var(--win95-text);
        }
        
        .win95-menu-item:hover {
            background-color: var(--win95-menu-hover-bg);
            color: var(--win95-menu-hover-text);
        }
        
        .win95-submenu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background-color: var(--win95-light);
            border: 2px solid;
            border-color: var(--win95-lighter) var(--win95-darker) var(--win95-darker) var(--win95-lighter);
            z-index: 100;
            min-width: 150px;
            box-shadow: 1px 1px 0 var(--win95-darkest);
        }
        
        .win95-menu-item:hover .win95-submenu {
            display: block;
        }
        
        .win95-submenu-item {
            padding: 4px 15px;
            color: var(--win95-text);
            cursor: pointer;
            white-space: nowrap;
        }
        
        .win95-submenu-item.disabled {
            color: var(--win95-darker);
        }
        
        .win95-submenu-item:not(.disabled):hover {
            background-color: var(--win95-menu-hover-bg);
            color: var(--win95-menu-hover-text);
        }
        
        .win95-separator {
            height: 1px;
            background-color: var(--win95-darker);
            border-bottom: 1px solid var(--win95-lighter);
            margin: 3px 2px;
        }

        /* --- Toolbar --- */
        .win95-toolbar {
            background-color: var(--win95-light);
            border-bottom: 1px solid var(--win95-darker);
            padding: 3px;
            display: flex;
            align-items: center;
            gap: 2px;
        }
        
        .win95-toolbar-button {
            padding: 2px 4px;
            border-width: 1px;
            border-style: solid;
            border-color: var(--win95-light);
            background-color: var(--win95-light);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 2px;
            height: 24px;
        }
        
        .win95-toolbar-button:hover {
            border-color: var(--win95-lighter) var(--win95-darker) var(--win95-darker) var(--win95-lighter);
        }
        
        .win95-toolbar-button:active {
            border-color: var(--win95-darker) var(--win95-lighter) var(--win95-lighter) var(--win95-darker);
            padding: 3px 3px 1px 5px;
        }
        
        .win95-toolbar-button i {
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        
        .win95-toolbar-separator {
            width: 1px;
            height: 20px;
            background-color: var(--win95-darker);
            border-right: 1px solid var(--win95-lighter);
            margin: 0 3px;
        }
        
        .win95-toolbar-spacer {
            flex-grow: 1;
        }
        
        .win95-address-bar {
            flex-grow: 1;
            display: flex;
            align-items: center;
            border-width: 2px;
            border-style: solid;
            border-color: var(--win95-darker) var(--win95-lighter) var(--win95-lighter) var(--win95-darker);
            background-color: white;
            padding: 0 5px;
            margin: 0 5px;
            height: 21px;
        }
        
        .win95-address-text {
            margin-right: 5px;
            font-weight: bold;
        }
        
        .win95-address-input {
            flex-grow: 1;
            border: none;
            outline: none;
            font-size: 11px;
            background-color: transparent;
            font-family: 'MS Sans Serif', Arial, sans-serif;
        }

        /* --- Repository Grid (Explorer Style) --- */
        .win95-explorer-view {
            display: flex;
            height: 100%;
        }
        
        .win95-folder-tree {
            width: 180px;
            border-right: 1px solid var(--win95-darker);
            overflow: auto;
            padding: 2px;
            background-color: white;
        }
        
        .win95-folder-item {
            display: flex;
            align-items: center;
            padding: 2px;
            cursor: pointer;
            white-space: nowrap;
        }
        
        .win95-folder-item:hover {
            background-color: var(--win95-menu-hover-bg);
            color: var(--win95-menu-hover-text);
        }
        
        .win95-folder-item.selected {
            background-color: var(--win95-menu-hover-bg);
            color: var(--win95-menu-hover-text);
        }
        
        .win95-folder-item i {
            margin-right: 5px;
            width: 16px;
            color: #aa8800;
        }
        
        .win95-repo-grid {
            flex-grow: 1;
            overflow: auto;
            padding: 5px;
            background-color: white;
            display: flex;
            flex-wrap: wrap;
            align-content: flex-start;
        }
        
        .win95-repo-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            width: 75px;
            height: 75px;
            margin: 5px;
            padding: 5px;
            cursor: pointer;
            text-align: center;
            overflow: hidden;
        }
        
        .win95-repo-item:hover {
            background-color: var(--win95-menu-hover-bg);
            color: var(--win95-menu-hover-text);
        }
        
        .win95-repo-item.selected {
            background-color: var(--win95-menu-hover-bg);
            color: var(--win95-menu-hover-text);
        }
        
        .win95-repo-icon {
            width: 32px;
            height: 32px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .win95-repo-icon i {
            font-size: 24px;
            color: var(--win95-blue);
        }
        
        .win95-repo-name {
            font-size: 11px;
            word-break: break-word;
            max-width: 100%;
            max-height: 34px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* View styles */
        .win95-view-list .win95-repo-item {
            width: 100%;
            height: auto;
            flex-direction: row;
            justify-content: flex-start;
            margin: 1px 5px;
            padding: 2px;
        }
        
        .win95-view-list .win95-repo-icon {
            width: 16px;
            height: 16px;
            margin-right: 5px;
            margin-bottom: 0;
        }
        
        .win95-view-list .win95-repo-icon i {
            font-size: 14px;
        }
        
        .win95-view-details .win95-repo-item {
            width: 100%;
            height: auto;
            flex-direction: row;
            justify-content: flex-start;
            margin: 0;
            padding: 2px;
            border-bottom: 1px dotted var(--win95-darker);
        }
        
        .win95-view-details .win95-repo-icon {
            width: 16px;
            height: 16px;
            margin-right: 5px;
            margin-bottom: 0;
        }
        
        .win95-view-details .win95-repo-icon i {
            font-size: 14px;
        }
        
        .win95-view-details .win95-repo-name {
            width: 150px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .win95-view-details .win95-repo-details {
            display: flex;
            flex: 1;
        }
        
        .win95-view-details .win95-repo-detail {
            width: 100px;
            padding: 0 5px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .win95-view-small .win95-repo-item {
            width: 60px;
            height: 60px;
        }
        
        .win95-view-small .win95-repo-icon {
            width: 16px;
            height: 16px;
        }
        
        .win95-view-small .win95-repo-icon i {
            font-size: 14px;
        }
        
        .win95-details-header {
            display: flex;
            padding: 2px;
            border-bottom: 1px solid var(--win95-darker);
            background-color: var(--win95-light);
            font-weight: bold;
            margin-bottom: 2px;
        }
        
        .win95-details-header-item {
            padding: 2px 5px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .win95-details-header-item:first-child {
            width: 178px; /* Name + icon width */
        }
        
        .win95-details-header-item:not(:first-child) {
            width: 100px;
        }

        /* --- Taskbar --- */
        .win95-taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 28px;
            background-color: var(--win95-light);
            border-top: 1px solid var(--win95-lighter);
            display: flex;
            z-index: 9999;
        }
        
        .win95-start-button {
            height: 100%;
            padding: 1px 5px;
            margin-right: 2px;
            display: flex;
            align-items: center;
            border-width: 2px;
            border-style: solid;
            border-color: var(--win95-lighter) var(--win95-darker) var(--win95-darker) var(--win95-lighter);
            cursor: pointer;
            font-weight: bold;
            background-color: var(--win95-light);
        }
        
        .win95-start-button.active {
            border-color: var(--win95-darker) var(--win95-lighter) var(--win95-lighter) var(--win95-darker);
            padding: 2px 4px 0px 6px;
        }
        
        .win95-start-logo {
            width: 16px;
            height: 16px;
            margin-right: 5px;
            display: flex;
            background-color: transparent;
        }
        
        .win95-start-logo-img {
            width: 100%;
            height: 100%;
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
        }
        
        .win95-start-logo-section {
            width: 100%;
            height: 100%;
        }
        
        .win95-start-logo-section:nth-child(1) {
            background-color: #FF0000;
        }
        .win95-start-logo-section:nth-child(2) {
            background-color: #00FF00;
        }
        .win95-start-logo-section:nth-child(3) {
            background-color: #0000FF;
        }
        .win95-start-logo-section:nth-child(4) {
            background-color: #FFFF00;
        }
        
        .win95-taskbar-items {
            display: flex;
            flex-grow: 1;
            padding: 2px;
            overflow: hidden;
        }
        
        .win95-taskbar-item {
            height: 22px;
            padding: 3px 8px;
            margin-right: 2px;
            display: flex;
            align-items: center;
            border-width: 2px;
            border-style: solid;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 180px;
            min-width: 120px;
            cursor: pointer;
            font-size: 11px;
        }
        
        .win95-taskbar-item.active {
            border-color: var(--win95-darker) var(--win95-lighter) var(--win95-lighter) var(--win95-darker);
            background-color: var(--win95-light);
        }
        
        .win95-taskbar-item.inactive {
            border-color: var(--win95-lighter) var(--win95-darker) var(--win95-darker) var(--win95-lighter);
            background-color: var(--win95-light);
        }
        
        .win95-taskbar-item i {
            margin-right: 4px;
            font-size: 14px;
        }
        
        .win95-taskbar-tray {
            height: 100%;
            display: flex;
            align-items: center;
            padding: 0 5px;
            border-left: 1px solid var(--win95-darker);
            border-top: 1px solid var(--win95-darker);
        }
        
        .win95-tray-icon {
            width: 16px;
            height: 16px;
            margin-right: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        
        .win95-clock {
            min-width: 70px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
        }

        /* --- Start Menu --- */
        .win95-start-menu {
            position: fixed;
            bottom: 28px;
            left: 0;
            width: 190px;
            background-color: var(--win95-light);
            border-width: 2px;
            border-style: solid;
            border-color: var(--win95-lighter) var(--win95-darker) var(--win95-darker) var(--win95-lighter);
            display: none;
            z-index: 10000;
            box-shadow: 2px 2px 3px rgba(0, 0, 0, 0.3);
        }
        
        .win95-start-menu.active {
            display: block;
        }
        
        .win95-start-sidebar {
            position: absolute;
            top: 2px;
            bottom: 2px;
            left: 2px;
            width: 21px;
            background-color: var(--win95-title-active);
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            align-items: center;
        }
        
        .win95-start-sidebar-text {
            color: white;
            writing-mode: vertical-rl;
            transform: rotate(180deg);
            text-align: center;
            padding: 5px 0;
            font-weight: bold;
            letter-spacing: 1px;
            text-transform: uppercase;
            font-size: 12px;
            margin-bottom: 10px;
        }
        
        .win95-start-menu-items {
            margin-left: 23px;
            padding: 2px 0;
        }
        
        .win95-start-menu-item {
            display: flex;
            align-items: center;
            padding: 3px 5px;
            cursor: pointer;
            height: 24px;
        }
        
        .win95-start-menu-item:hover {
            background-color: var(--win95-menu-hover-bg);
            color: var(--win95-menu-hover-text);
        }
        
        .win95-start-menu-item img {
            width: 16px;
            height: 16px;
            margin-right: 5px;
        }
        
        .win95-start-menu-item i {
            width: 16px;
            text-align: center;
            margin-right: 5px;
        }
        
        .win95-start-menu-item.has-submenu::after {
            content: '►';
            margin-left: auto;
            font-size: 8px;
        }
        
        .win95-submenu-nested {
            position: absolute;
            left: 100%;
            top: 0;
            background-color: var(--win95-light);
            border: 2px solid;
            border-color: var(--win95-lighter) var(--win95-darker) var(--win95-darker) var(--win95-lighter);
            display: none;
            min-width: 150px;
            box-shadow: 2px 2px 3px rgba(0, 0, 0, 0.3);
        }
        
        .win95-start-menu-item.has-submenu:hover .win95-submenu-nested {
            display: block;
        }

        /* --- Modal Dialog --- */
        .win95-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 400px;
            z-index: 10001;
            display: none;
        }
        
        .win95-modal-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.1);
            z-index: 10000;
            display: none;
        }
        
        .win95-modal-content {
            padding: 10px;
        }
        
        .win95-modal-row {
            display: flex;
            margin-bottom: 8px;
            padding-bottom: 8px;
        }
        
        .win95-modal-label {
            width: 120px;
            font-weight: bold;
        }
        
        .win95-modal-value {
            flex: 1;
        }
        
        .win95-modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 5px;
            margin-top: 16px;
        }

        /* --- Startup Screen --- */
        .win95-startup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #008080; /* Classic Windows 95 teal */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 20000;
            transition: opacity 0.5s, visibility 0.5s;
        }
        
        .win95-startup.hidden {
            opacity: 0;
            visibility: hidden;
        }
        
        .win95-logo {
            margin-bottom: 100px;
        }
        
        .win95-logo-text {
            color: white;
            font-size: 36px;
            font-weight: bold;
            display: flex;
            align-items: center;
        }
        
        .win95-logo-flag {
            width: 40px;
            height: 40px;
            margin-right: 10px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
        }
        
        .win95-logo-flag-section {
            width: 100%;
            height: 100%;
        }
        
        .win95-logo-flag-section:nth-child(1) {
            background-color: #FF0000;
        }
        .win95-logo-flag-section:nth-child(2) {
            background-color: #00FF00;
        }
        .win95-logo-flag-section:nth-child(3) {
            background-color: #0000FF;
        }
        .win95-logo-flag-section:nth-child(4) {
            background-color: #FFFF00;
        }
        
        .win95-startup-loading {
            position: absolute;
            bottom: 40px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
        }
        
        .win95-startup-message {
            color: white;
            font-size: 14px;
            margin-bottom: 20px;
        }
        
        .win95-progress-box {
            width: 300px;
            height: 15px;
            border: 1px solid white;
            position: relative;
            overflow: hidden;
        }
        
        .win95-progress-bar {
            height: 100%;
            background-color: white;
            width: 20%;
            position: absolute;
            animation: win95-loading 3s infinite;
        }
        
        @keyframes win95-loading {
            0% { left: -50%; }
            100% { left: 100%; }
        }

        /* --- Error Dialog --- */
        .win95-error {
            background-color: var(--win95-light);
            border-width: 2px;
            border-style: solid;
            border-color: var(--win95-lighter) var(--win95-darker) var(--win95-darker) var(--win95-lighter);
            max-width: 400px;
            margin: 100px auto;
        }
        
        .win95-error-content {
            padding: 16px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        
        .win95-error-icon {
            font-size: 32px;
            color: #FF0000;
        }
        
        .win95-error-message {
            flex: 1;
        }
        
        .win95-error-buttons {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        /* --- Scrollbars --- */
        ::-webkit-scrollbar {
            width: 16px;
            height: 16px;
        }
        
        ::-webkit-scrollbar-track {
            background-color: var(--win95-light);
        }
        
        ::-webkit-scrollbar-thumb {
            background-color: var(--win95-light);
            border-width: 1px;
            border-style: solid;
            border-color: var(--win95-lighter) var(--win95-darker) var(--win95-darker) var(--win95-lighter);
        }
        
        ::-webkit-scrollbar-button {
            background-color: var(--win95-light);
            border-width: 1px;
            border-style: solid;
            border-color: var(--win95-lighter) var(--win95-darker) var(--win95-darker) var(--win95-lighter);
            display: block;
            height: 16px;
            width: 16px;
        }
        
        ::-webkit-scrollbar-button:active {
            border-color: var(--win95-darker) var(--win95-lighter) var(--win95-lighter) var(--win95-darker);
        }
        
        ::-webkit-scrollbar-corner {
            background-color: var(--win95-light);
        }

        /* --- Desktop Icons --- */
        .win95-desktop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 28px;
            overflow: auto;
            z-index: 1;
        }
        
        .win95-desktop-icon {
            width: 75px;
            text-align: center;
            padding: 5px;
            margin: 10px;
            cursor: pointer;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .win95-desktop-icon:hover {
            background-color: rgba(0, 0, 128, 0.3);
        }
        
        .win95-desktop-icon.selected {
            background-color: rgba(0, 0, 128, 0.5);
        }
        
        .win95-desktop-icon-img {
            width: 32px;
            height: 32px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .win95-desktop-icon-img i {
            font-size: 24px;
        }
        
        .win95-desktop-icon-text {
            font-size: 11px;
            word-break: break-word;
            text-shadow: 1px 1px 1px black;
        }

        /* --- Context Menu --- */
        .win95-context-menu {
            position: absolute;
            background-color: var(--win95-light);
            border-width: 2px;
            border-style: solid;
            border-color: var(--win95-lighter) var(--win95-darker) var(--win95-darker) var(--win95-lighter);
            z-index: 1000;
            display: none;
            padding: 2px;
            min-width: 150px;
            box-shadow: 2px 2px 3px rgba(0, 0, 0, 0.3);
        }
        
        .win95-context-item {
            padding: 3px 20px;
            cursor: pointer;
            white-space: nowrap;
            font-size: 11px;
        }
        
        .win95-context-item:hover {
            background-color: var(--win95-menu-hover-bg);
            color: var(--win95-menu-hover-text);
        }
        
        .win95-context-item.disabled {
            color: var(--win95-darker);
            cursor: default;
        }
        
        .win95-context-item.disabled:hover {
            background-color: transparent;
            color: var(--win95-darker);
        }

        /* --- Minesweeper --- */
        .minesweeper-window {
            width: 200px;
            height: 300px;
            position: absolute;
            top: 100px;
            left: 300px;
        }
        
        .minesweeper-content {
            display: flex;
            flex-direction: column;
            padding: 5px;
            background-color: var(--minesweeper-bg);
            height: 100%;
            box-sizing: border-box;
        }
        
        .minesweeper-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px;
            margin-bottom: 5px;
            border-width: 2px;
            border-style: solid;
            border-color: var(--win95-darker) var(--win95-lighter) var(--win95-lighter) var(--win95-darker);
        }
        
        .minesweeper-counter {
            background-color: black;
            color: red;
            font-family: 'Digital-7', monospace;
            padding: 2px 5px;
            width: 45px;
            text-align: right;
            font-size: 14px;
            font-weight: bold;
            border-width: 1px;
            border-style: solid;
            border-color: var(--win95-darker) var(--win95-lighter) var(--win95-lighter) var(--win95-darker);
        }
        
        .minesweeper-face {
            width: 25px;
            height: 25px;
            border-width: 2px;
            border-style: solid;
            border-color: var(--win95-lighter) var(--win95-darker) var(--win95-darker) var(--win95-lighter);
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--win95-light);
            cursor: pointer;
            font-size: 16px;
        }
        
        .minesweeper-face:active {
            border-color: var(--win95-darker) var(--win95-lighter) var(--win95-lighter) var(--win95-darker);
        }
        
        .minesweeper-grid {
            flex-grow: 1;
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            grid-template-rows: repeat(9, 1fr);
            gap: 0;
            margin: 0 auto;
            border-width: 3px;
            border-style: solid;
            border-color: var(--win95-darker) var(--win95-lighter) var(--win95-lighter) var(--win95-darker);
            padding: 1px;
        }
        
        .minesweeper-cell {
            background-color: var(--win95-light);
            border-width: 2px;
            border-style: solid;
            border-color: var(--win95-lighter) var(--win95-darker) var(--win95-darker) var(--win95-lighter);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            font-size: 12px;
            line-height: 1;
            user-select: none;
        }
        
        .minesweeper-cell.revealed {
            border-style: solid;
            border-width: 1px;
            border-color: var(--win95-darker);
            background-color: var(--minesweeper-revealed);
        }
        
        .minesweeper-cell.flagged::after {
            content: '🚩';
            font-size: 10px;
        }
        
        .minesweeper-cell.mine-clicked {
            background-color: red;
        }
        
        .minesweeper-cell.mine::after {
            content: '💣';
            font-size: 10px;
        }
        
        .minesweeper-cell.number-1 {
            color: var(--minesweeper-1);
        }
        
        .minesweeper-cell.number-2 {
            color: var(--minesweeper-2);
        }
        
        .minesweeper-cell.number-3 {
            color: var(--minesweeper-3);
        }
        
        .minesweeper-cell.number-4 {
            color: var(--minesweeper-4);
        }
        
        .minesweeper-cell.number-5 {
            color: var(--minesweeper-5);
        }
        
        .minesweeper-cell.number-6 {
            color: var(--minesweeper-6);
        }
        
        .minesweeper-cell.number-7 {
            color: var(--minesweeper-7);
        }
        
        .minesweeper-cell.number-8 {
            color: var(--minesweeper-8);
        }

        /* --- Notepad --- */
        .notepad-textarea {
            width: 100%;
            height: 100%;
            resize: none;
            border: none;
            padding: 2px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            outline: none;
        }

        /* --- Common Dialog --- */
        .win95-common-dialog {
            width: 320px;
            height: auto;
            position: absolute;
            top: 120px;
            left: 150px;
            z-index: 1001;
            display: none;
        }
        
        .win95-common-dialog-content {
            padding: 10px;
            display: flex;
            flex-direction: column;
        }
        
        .win95-common-dialog-icon {
            float: left;
            margin-right: 10px;
            font-size: 32px;
        }
        
        .win95-common-dialog-text {
            margin-bottom: 15px;
            min-height: 32px;
            display: flex;
            align-items: center;
        }
        
        .win95-common-dialog-buttons {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin-top: 10px;
        }

        /* --- Responsiveness --- */
        @media (max-width: 768px) {
            .win95-explorer-view {
                flex-direction: column;
            }
            
            .win95-folder-tree {
                width: 100%;
                height: 150px;
                border-right: none;
                border-bottom: 1px solid var(--win95-darker);
            }
            
            .win95-modal {
                width: 95%;
            }
        }

        /* --- System Sounds --- */
        .win95-audio {
            display: none;
        }
    </style>
</head>
<body>
    <!-- System Sounds -->
    <audio id="win95-startup-sound" class="win95-audio">
        <source src="https://archive.org/download/WindowsStartupSounds/Windows%2095.mp3" type="audio/mpeg">
    </audio>
    <audio id="win95-error-sound" class="win95-audio">
        <source src="https://archive.org/download/WindowsXpSoundEffects/Windows%20XP%20Error.mp3" type="audio/mpeg">
    </audio>
    <audio id="win95-click-sound" class="win95-audio">
        <source src="https://archive.org/download/WindowsXpSoundEffects/Windows%20XP%20Navigation%20Start.mp3" type="audio/mpeg">
    </audio>

    <!-- Windows 95 Startup Screen -->
    <div class="win95-startup">
        <div class="win95-logo">
            <div class="win95-logo-text">
                <div class="win95-logo-flag">
                    <div class="win95-logo-flag-section"></div>
                    <div class="win95-logo-flag-section"></div>
                    <div class="win95-logo-flag-section"></div>
                    <div class="win95-logo-flag-section"></div>
                </div>
                Microsoft<sup>®</sup> Windows<sup>®</sup> 95
            </div>
        </div>
        <div class="win95-startup-message">Starting Windows 95...</div>
        <div class="win95-startup-loading">
            <div class="win95-progress-box">
                <div class="win95-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Desktop -->
    <div class="win95-desktop">
        <div class="win95-desktop-icon" id="my-computer-icon">
            <div class="win95-desktop-icon-img">
                <i class="fas fa-desktop"></i>
            </div>
            <div class="win95-desktop-icon-text">My Computer</div>
        </div>
        <div class="win95-desktop-icon" id="network-icon">
            <div class="win95-desktop-icon-img">
                <i class="fas fa-network-wired"></i>
            </div>
            <div class="win95-desktop-icon-text">Network Neighborhood</div>
        </div>
        <div class="win95-desktop-icon" id="recycle-bin-icon">
            <div class="win95-desktop-icon-img">
                <i class="fas fa-trash-alt"></i>
            </div>
            <div class="win95-desktop-icon-text">Recycle Bin</div>
        </div>
        <div class="win95-desktop-icon" id="internet-explorer-icon">
            <div class="win95-desktop-icon-img">
                <i class="fab fa-internet-explorer"></i>
            </div>
            <div class="win95-desktop-icon-text">Internet Explorer</div>
        </div>
        <div class="win95-desktop-icon" id="github-icon">
            <div class="win95-desktop-icon-img">
                <i class="fab fa-github"></i>
            </div>
            <div class="win95-desktop-icon-text">GitHub Explorer</div>
        </div>
        <div class="win95-desktop-icon" id="minesweeper-icon">
            <div class="win95-desktop-icon-img">
                <i class="fas fa-bomb"></i>
            </div>
            <div class="win95-desktop-icon-text">Minesweeper</div>
        </div>
        <div class="win95-desktop-icon" id="notepad-icon">
            <div class="win95-desktop-icon-img">
                <i class="fas fa-sticky-note"></i>
            </div>
            <div class="win95-desktop-icon-text">Notepad</div>
        </div>
    </div>

    <!-- Main Explorer Window -->
    <div class="win95-window" id="explorer-window" style="width: 600px; height: 400px; top: 50px; left: 50px; display: none;">
        <div class="win95-title-bar" id="explorer-title-bar">
            <div class="win95-title">
                <i class="fab fa-github win95-title-icon"></i>
                GitHub Explorer - Swir
            </div>
            <div class="win95-buttons">
                <div class="win95-window-button" id="explorer-minimize">_</div>
                <div class="win95-window-button" id="explorer-maximize">□</div>
                <div class="win95-window-button" id="explorer-close">×</div>
            </div>
        </div>
        
        <div class="win95-menu-bar">
            <div class="win95-menu-item">
                File
                <div class="win95-submenu">
                    <div class="win95-submenu-item" id="menu-new">New</div>
                    <div class="win95-submenu-item" id="menu-open">Open</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="refresh-repos">Refresh</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="menu-properties">Properties</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="menu-close">Close</div>
                </div>
            </div>
            <div class="win95-menu-item">
                Edit
                <div class="win95-submenu">
                    <div class="win95-submenu-item disabled">Cut</div>
                    <div class="win95-submenu-item" id="menu-copy">Copy</div>
                    <div class="win95-submenu-item disabled">Paste</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item disabled">Select All</div>
                </div>
            </div>
            <div class="win95-menu-item">
                View
                <div class="win95-submenu">
                    <div class="win95-submenu-item" id="view-toolbar">Toolbar</div>
                    <div class="win95-submenu-item" id="view-status-bar">Status Bar</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="view-large-icons">Large Icons</div>
                    <div class="win95-submenu-item" id="view-small-icons">Small Icons</div>
                    <div class="win95-submenu-item" id="view-list">List</div>
                    <div class="win95-submenu-item" id="view-details">Details</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="arrange-by-name">Arrange By Name</div>
                    <div class="win95-submenu-item" id="arrange-by-type">Arrange By Type</div>
                    <div class="win95-submenu-item" id="arrange-by-size">Arrange By Size</div>
                    <div class="win95-submenu-item" id="arrange-by-date">Arrange By Date</div>
                </div>
            </div>
            <div class="win95-menu-item">
                Help
                <div class="win95-submenu">
                    <div class="win95-submenu-item" id="menu-help-topics">Help Topics</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="menu-about">About GitHub Explorer</div>
                </div>
            </div>
        </div>
        
        <div class="win95-toolbar">
            <div class="win95-toolbar-button" id="back-button">
                <i class="fas fa-arrow-left"></i>
            </div>
            <div class="win95-toolbar-button" id="forward-button">
                <i class="fas fa-arrow-right"></i>
            </div>
            <div class="win95-toolbar-button" id="up-button">
                <i class="fas fa-arrow-up"></i>
            </div>
            <div class="win95-toolbar-separator"></div>
            <div class="win95-toolbar-button" id="cut-button">
                <i class="fas fa-cut"></i>
            </div>
            <div class="win95-toolbar-button" id="copy-button">
                <i class="fas fa-copy"></i>
            </div>
            <div class="win95-toolbar-button" id="paste-button">
                <i class="fas fa-paste"></i>
            </div>
            <div class="win95-toolbar-separator"></div>
            <div class="win95-toolbar-button" id="view-button">
                <i class="fas fa-th-large"></i>
            </div>
            <div class="win95-toolbar-spacer"></div>
            <div class="win95-address-bar">
                <div class="win95-address-text">Address:</div>
                <input type="text" class="win95-address-input" value="GitHub://Swir" readonly>
            </div>
        </div>
        
        <div class="win95-window-content">
            <div class="win95-explorer-view">
                <div class="win95-folder-tree">
                    <div class="win95-folder-item">
                        <i class="fas fa-hdd"></i> Desktop
                    </div>
                    <div class="win95-folder-item">
                        <i class="fas fa-folder"></i> GitHub
                    </div>
                    <div class="win95-folder-item selected">
                        <i class="fas fa-folder-open"></i> Swir
                    </div>
                    <div class="win95-folder-item">
                        <i class="fas fa-folder"></i> Stars
                    </div>
                    <div class="win95-folder-item">
                        <i class="fas fa-folder"></i> Forks
                    </div>
                    <div class="win95-folder-item">
                        <i class="fas fa-folder"></i> Trending
                    </div>
                </div>
                <div class="win95-repo-grid" id="repos-container">
                    <!-- Loading repositories placeholder -->
                    <div class="win95-loading" style="width: 100%; text-align: center; padding: 50px;">
                        <img src="/api/placeholder/32/32" alt="Loading..." style="margin-bottom: 10px;">
                        <div>Loading repositories...</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="win95-status-bar">
            <div class="win95-status-section" id="repo-count">0 object(s)</div>
            <div class="win95-status-section">GitHub Explorer</div>
            <div class="win95-status-section" id="memory-display">32.5MB free</div>
        </div>
    </div>

    <!-- Minesweeper Window -->
    <div class="win95-window minesweeper-window" id="minesweeper-window" style="display: none;">
        <div class="win95-title-bar" id="minesweeper-title-bar">
            <div class="win95-title">
                <i class="fas fa-bomb win95-title-icon"></i>
                Minesweeper
            </div>
            <div class="win95-buttons">
                <div class="win95-window-button" id="minesweeper-minimize">_</div>
                <div class="win95-window-button" id="minesweeper-close">×</div>
            </div>
        </div>
        
        <div class="win95-menu-bar">
            <div class="win95-menu-item">
                Game
                <div class="win95-submenu">
                    <div class="win95-submenu-item" id="new-game">New</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="beginner">Beginner</div>
                    <div class="win95-submenu-item" id="intermediate">Intermediate</div>
                    <div class="win95-submenu-item" id="expert">Expert</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="minesweeper-exit">Exit</div>
                </div>
            </div>
            <div class="win95-menu-item">
                Help
                <div class="win95-submenu">
                    <div class="win95-submenu-item" id="minesweeper-help">Help Topics</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="minesweeper-about">About Minesweeper</div>
                </div>
            </div>
        </div>
        
        <div class="win95-window-content" style="overflow: hidden;">
            <div class="minesweeper-content">
                <div class="minesweeper-header">
                    <div class="minesweeper-counter" id="mines-counter">010</div>
                    <div class="minesweeper-face" id="minesweeper-face">😊</div>
                    <div class="minesweeper-counter" id="time-counter">000</div>
                </div>
                <div class="minesweeper-grid" id="minesweeper-grid"></div>
            </div>
        </div>
    </div>

    <!-- Notepad Window -->
    <div class="win95-window" id="notepad-window" style="width: 500px; height: 400px; top: 70px; left: 120px; display: none;">
        <div class="win95-title-bar" id="notepad-title-bar">
            <div class="win95-title">
                <i class="fas fa-sticky-note win95-title-icon"></i>
                Untitled - Notepad
            </div>
            <div class="win95-buttons">
                <div class="win95-window-button" id="notepad-minimize">_</div>
                <div class="win95-window-button" id="notepad-maximize">□</div>
                <div class="win95-window-button" id="notepad-close">×</div>
            </div>
        </div>
        
        <div class="win95-menu-bar">
            <div class="win95-menu-item">
                File
                <div class="win95-submenu">
                    <div class="win95-submenu-item" id="notepad-new">New</div>
                    <div class="win95-submenu-item" id="notepad-open">Open...</div>
                    <div class="win95-submenu-item" id="notepad-save">Save</div>
                    <div class="win95-submenu-item" id="notepad-save-as">Save As...</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="notepad-print">Print...</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="notepad-exit">Exit</div>
                </div>
            </div>
            <div class="win95-menu-item">
                Edit
                <div class="win95-submenu">
                    <div class="win95-submenu-item" id="notepad-undo">Undo</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="notepad-cut">Cut</div>
                    <div class="win95-submenu-item" id="notepad-copy">Copy</div>
                    <div class="win95-submenu-item" id="notepad-paste">Paste</div>
                    <div class="win95-submenu-item" id="notepad-delete">Delete</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="notepad-select-all">Select All</div>
                    <div class="win95-submenu-item" id="notepad-time-date">Time/Date</div>
                </div>
            </div>
            <div class="win95-menu-item">
                Format
                <div class="win95-submenu">
                    <div class="win95-submenu-item" id="notepad-word-wrap">Word Wrap</div>
                    <div class="win95-submenu-item" id="notepad-font">Font...</div>
                </div>
            </div>
            <div class="win95-menu-item">
                Help
                <div class="win95-submenu">
                    <div class="win95-submenu-item" id="notepad-help-topics">Help Topics</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="notepad-about">About Notepad</div>
                </div>
            </div>
        </div>
        
        <div class="win95-window-content" style="overflow: hidden; padding: 0;">
            <textarea id="notepad-textarea" class="notepad-textarea"></textarea>
        </div>
    </div>

    <!-- My Computer Window -->
    <div class="win95-window" id="my-computer-window" style="width: 600px; height: 400px; top: 60px; left: 80px; display: none;">
        <div class="win95-title-bar" id="my-computer-title-bar">
            <div class="win95-title">
                <i class="fas fa-desktop win95-title-icon"></i>
                My Computer
            </div>
            <div class="win95-buttons">
                <div class="win95-window-button" id="my-computer-minimize">_</div>
                <div class="win95-window-button" id="my-computer-maximize">□</div>
                <div class="win95-window-button" id="my-computer-close">×</div>
            </div>
        </div>
        
        <div class="win95-menu-bar">
            <div class="win95-menu-item">
                File
                <div class="win95-submenu">
                    <div class="win95-submenu-item" id="my-computer-open">Open</div>
                    <div class="win95-submenu-item" id="my-computer-explore">Explore</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="my-computer-close-menu">Close</div>
                </div>
            </div>
            <div class="win95-menu-item">
                Edit
                <div class="win95-submenu">
                    <div class="win95-submenu-item disabled">Cut</div>
                    <div class="win95-submenu-item disabled">Copy</div>
                    <div class="win95-submenu-item disabled">Paste</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item disabled">Select All</div>
                </div>
            </div>
            <div class="win95-menu-item">
                View
                <div class="win95-submenu">
                    <div class="win95-submenu-item" id="my-computer-toolbar">Toolbar</div>
                    <div class="win95-submenu-item" id="my-computer-status-bar">Status Bar</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="my-computer-large-icons">Large Icons</div>
                    <div class="win95-submenu-item" id="my-computer-small-icons">Small Icons</div>
                    <div class="win95-submenu-item" id="my-computer-list">List</div>
                    <div class="win95-submenu-item" id="my-computer-details">Details</div>
                </div>
            </div>
            <div class="win95-menu-item">
                Help
                <div class="win95-submenu">
                    <div class="win95-submenu-item" id="my-computer-help-topics">Help Topics</div>
                    <div class="win95-separator"></div>
                    <div class="win95-submenu-item" id="my-computer-about">About My Computer</div>
                </div>
            </div>
        </div>
        
        <div class="win95-toolbar">
            <div class="win95-toolbar-button" id="my-computer-back-button">
                <i class="fas fa-arrow-left"></i>
            </div>
            <div class="win95-toolbar-separator"></div>
            <div class="win95-toolbar-button" id="my-computer-cut-button">
                <i class="fas fa-cut"></i>
            </div>
            <div class="win95-toolbar-button" id="my-computer-copy-button">
                <i class="fas fa-copy"></i>
            </div>
            <div class="win95-toolbar-button" id="my-computer-paste-button">
                <i class="fas fa-paste"></i>
            </div>
            <div class="win95-toolbar-separator"></div>
            <div class="win95-toolbar-button" id="my-computer-properties-button">
                <i class="fas fa-cog"></i>
            </div>
            <div class="win95-toolbar-spacer"></div>
        </div>
        
        <div class="win95-window-content">
            <div class="win95-explorer-view">
                <div class="win95-repo-grid" id="my-computer-container" style="background-color: white;">
                    <div class="win95-repo-item" data-type="drive" data-drive="c">
                        <div class="win95-repo-icon">
                            <i class="fas fa-hdd"></i>
                        </div>
                        <div class="win95-repo-name">(C:) Hard Disk</div>
                    </div>
                    <div class="win95-repo-item" data-type="drive" data-drive="d">
                        <div class="win95-repo-icon">
                            <i class="fas fa-compact-disc"></i>
                        </div>
                        <div class="win95-repo-name">(D:) CD-ROM Drive</div>
                    </div>
                    <div class="win95-repo-item" data-type="drive" data-drive="a">
                        <div class="win95-repo-icon">
                            <i class="fas fa-save"></i>
                        </div>
                        <div class="win95-repo-name">(A:) Floppy Disk</div>
                    </div>
                    <div class="win95-repo-item" data-type="folder" data-folder="control-panel">
                        <div class="win95-repo-icon">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <div class="win95-repo-name">Control Panel</div>
                    </div>
                    <div class="win95-repo-item" data-type="folder" data-folder="printers">
                        <div class="win95-repo-icon">
                            <i class="fas fa-print"></i>
                        </div>
                        <div class="win95-repo-name">Printers</div>
                    </div>
                    <div class="win95-repo-item" data-type="folder" data-folder="dial-up">
                        <div class="win95-repo-icon">
                            <i class="fas fa-phone"></i>
                        </div>
                        <div class="win95-repo-name">Dial-Up Networking</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="win95-status-bar">
            <div class="win95-status-section" id="my-computer-status">6 object(s)</div>
            <div class="win95-status-section"></div>
        </div>
    </div>

    <!-- Repository Properties Dialog -->
    <div class="win95-modal" id="repo-properties-modal">
        <div class="win95-window" style="width: 100%;">
            <div class="win95-title-bar">
                <div class="win95-title" id="modal-repo-name">Repository Properties</div>
                <div class="win95-buttons">
                    <div class="win95-window-button" id="modal-close">×</div>
                </div>
            </div>
            
            <div class="win95-window-content" style="position: static; bottom: auto; height: auto; max-height: 400px;">
                <div class="win95-modal-content" id="repo-details-content">
                    <!-- Repository details will be inserted here -->
                </div>
            </div>
            
            <div class="win95-status-bar">
                <div class="win95-status-section">Repository Properties</div>
            </div>
        </div>
    </div>

    <!-- About Dialog -->
    <div class="win95-modal" id="about-modal">
        <div class="win95-window" style="width: 100%;">
            <div class="win95-title-bar">
                <div class="win95-title">About GitHub Explorer</div>
                <div class="win95-buttons">
                    <div class="win95-window-button" id="about-close">×</div>
                </div>
            </div>
            
            <div class="win95-window-content" style="position: static; bottom: auto; height: auto;">
                <div class="win95-modal-content" style="text-align: center; padding: 20px;">
                    <div style="font-size: 24px; font-weight: bold; margin-bottom: 10px;">GitHub Explorer</div>
                    <div style="font-size: 12px; color: #666; margin-bottom: 20px;">Version 1.0</div>
                    <p>A nostalgic Windows 95 style interface for browsing GitHub repositories.</p>
                    <p style="margin-top: 20px;">© 2025 Swir</p>
                    
                    <div class="win95-modal-buttons">
                        <button class="win95-button" id="about-ok">OK</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Common Dialog -->
    <div class="win95-window win95-common-dialog" id="common-dialog">
        <div class="win95-title-bar">
            <div class="win95-title" id="dialog-title">Windows</div>
            <div class="win95-buttons">
                <div class="win95-window-button" id="dialog-close">×</div>
            </div>
        </div>
        
        <div class="win95-window-content" style="position: static; bottom: auto; height: auto;">
            <div class="win95-common-dialog-content">
                <div class="win95-common-dialog-text">
                    <div class="win95-common-dialog-icon" id="dialog-icon">
                        <i class="fas fa-info-circle"></i>
                    </div>
                    <div id="dialog-message">This is a message.</div>
                </div>
                
                <div class="win95-common-dialog-buttons">
                    <button class="win95-button" id="dialog-ok">OK</button>
                    <button class="win95-button" id="dialog-cancel" style="display: none;">Cancel</button>
                    <button class="win95-button" id="dialog-yes" style="display: none;">Yes</button>
                    <button class="win95-button" id="dialog-no" style="display: none;">No</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Run Dialog -->
    <div class="win95-window win95-common-dialog" id="run-dialog" style="width: 320px; height: auto; top: 150px; left: 200px; display: none;">
        <div class="win95-title-bar">
            <div class="win95-title">Run</div>
            <div class="win95-buttons">
                <div class="win95-window-button" id="run-close">×</div>
            </div>
        </div>
        
        <div class="win95-window-content" style="position: static; bottom: auto; height: auto;">
            <div class="win95-common-dialog-content">
                <div style="display: flex; align-items: center; margin-bottom: 15px;">
                    <img src="/api/placeholder/32/32" alt="Run" style="margin-right: 10px;">
                    <div>
                        Type the name of a program, folder, document, or Internet resource, and Windows will open it for you.
                    </div>
                </div>
                
                <div style="display: flex; margin-bottom: 10px;">
                    <div style="width: 40px; font-weight: bold;">Open:</div>
                    <input type="text" id="run-command" style="flex-grow: 1; border: 1px solid var(--win95-darker); padding: 3px;">
                </div>
                
                <div class="win95-common-dialog-buttons" style="justify-content: flex-end;">
                    <button class="win95-button" id="run-ok">OK</button>
                    <button class="win95-button" id="run-cancel">Cancel</button>
                    <button class="win95-button" id="run-browse">Browse...</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Start Menu -->
    <div class="win95-start-menu" id="start-menu">
        <div class="win95-start-sidebar">
            <div class="win95-start-sidebar-text">Windows 95</div>
        </div>
        <div class="win95-start-menu-items">
            <div class="win95-start-menu-item has-submenu">
                <i class="fas fa-folder"></i> Programs
                <div class="win95-submenu-nested">
                    <div class="win95-start-menu-item has-submenu">
                        <i class="fas fa-folder"></i> Accessories
                        <div class="win95-submenu-nested">
                            <div class="win95-start-menu-item" id="start-notepad">
                                <i class="fas fa-sticky-note"></i> Notepad
                            </div>
                            <div class="win95-start-menu-item" id="start-paint">
                                <i class="fas fa-paint-brush"></i> Paint
                            </div>
                            <div class="win95-start-menu-item" id="start-calculator">
                                <i class="fas fa-calculator"></i> Calculator
                            </div>
                        </div>
                    </div>
                    <div class="win95-separator"></div>
                    <div class="win95-start-menu-item" id="start-internet-explorer">
                        <i class="fab fa-internet-explorer"></i> Internet Explorer
                    </div>
                    <div class="win95-start-menu-item" id="start-minesweeper">
                        <i class="fas fa-bomb"></i> Minesweeper
                    </div>
                    <div class="win95-start-menu-item" id="start-explorer">
                        <i class="fab fa-github"></i> GitHub Explorer
                    </div>
                </div>
            </div>
            <div class="win95-start-menu-item has-submenu">
                <i class="fas fa-file"></i> Documents
                <div class="win95-submenu-nested">
                    <div class="win95-start-menu-item disabled">
                        <i class="fas fa-file-alt"></i> (Empty)
                    </div>
                </div>
            </div>
            <div class="win95-start-menu-item has-submenu">
                <i class="fas fa-cog"></i> Settings
                <div class="win95-submenu-nested">
                    <div class="win95-start-menu-item has-submenu">
                        <i class="fas fa-desktop"></i> Control Panel
                        <div class="win95-submenu-nested">
                            <div class="win95-start-menu-item">
                                <i class="fas fa-palette"></i> Display
                            </div>
                            <div class="win95-start-menu-item">
                                <i class="fas fa-mouse"></i> Mouse
                            </div>
                            <div class="win95-start-menu-item">
                                <i class="fas fa-volume-up"></i> Sounds
                            </div>
                        </div>
                    </div>
                    <div class="win95-start-menu-item">
                        <i class="fas fa-print"></i> Printers
                    </div>
                    <div class="win95-start-menu-item">
                        <i class="fas fa-bars"></i> Taskbar
                    </div>
                </div>
            </div>
            <div class="win95-start-menu-item has-submenu">
                <i class="fas fa-search"></i> Find
                <div class="win95-submenu-nested">
                    <div class="win95-start-menu-item">
                        <i class="fas fa-file"></i> Files or Folders...
                    </div>
                    <div class="win95-start-menu-item">
                        <i class="fas fa-user"></i> Computer...
                    </div>
                    <div class="win95-separator"></div>
                    <div class="win95-start-menu-item">
                        <i class="fas fa-globe"></i> On the Internet...
                    </div>
                </div>
            </div>
            <div class="win95-start-menu-item">
                <i class="fas fa-question-circle"></i> Help
            </div>
            <div class="win95-start-menu-item" id="start-run">
                <i class="fas fa-play"></i> Run...
            </div>
            <div class="win95-separator"></div>
            <div class="win95-start-menu-item" id="start-shutdown">
                <i class="fas fa-power-off"></i> Shut Down...
            </div>
        </div>
    </div>

    <!-- Context Menu -->
    <div class="win95-context-menu" id="repo-context-menu">
        <div class="win95-context-item" id="context-open">Open</div>
        <div class="win95-context-item" id="context-view-github">View on GitHub</div>
        <div class="win95-separator"></div>
        <div class="win95-context-item" id="context-copy-url">Copy URL</div>
        <div class="win95-context-item" id="context-properties">Properties</div>
    </div>

    <!-- Desktop Context Menu -->
    <div class="win95-context-menu" id="desktop-context-menu">
        <div class="win95-context-item" id="desktop-arrange-icons">Arrange Icons</div>
        <div class="win95-context-item" id="desktop-refresh">Refresh</div>
        <div class="win95-separator"></div>
        <div class="win95-context-item" id="desktop-properties">Properties</div>
    </div>

    <div class="win95-modal-background" id="modal-background"></div>

    <!-- Taskbar -->
    <div class="win95-taskbar">
        <div class="win95-start-button" id="start-button">
            <div class="win95-start-logo">
                <div class="win95-start-logo-img">
                    <div class="win95-start-logo-section"></div>
                    <div class="win95-start-logo-section"></div>
                    <div class="win95-start-logo-section"></div>
                    <div class="win95-start-logo-section"></div>
                </div>
            </div>
            Start
        </div>
        <div class="win95-taskbar-items" id="taskbar-items">
            <!-- Taskbar items will be added here -->
        </div>
        <div class="win95-taskbar-tray">
            <div class="win95-tray-icon" id="volume-control">
                <i class="fas fa-volume-up"></i>
            </div>
            <div class="win95-clock" id="taskbar-clock">12:00 PM</div>
        </div>
    </div>

    <script>
        // Global variables
        let allRepos = [];
        let selectedRepo = null;
        let currentSort = 'updated';
        let isDragging = false;
        let dragOffsetX = 0;
        let dragOffsetY = 0;
        let currentView = 'large';
        let isStartMenuOpen = false;
        let selectedRepoIndex = -1;
        
        // Window state management
        let windows = {
            'explorer': {
                isOpen: false,
                isMinimized: false,
                isActive: false
            },
            'minesweeper': {
                isOpen: false,
                isMinimized: false,
                isActive: false
            },
            'notepad': {
                isOpen: false,
                isMinimized: false,
                isActive: false
            },
            'my-computer': {
                isOpen: false,
                isMinimized: false,
                isActive: false
            }
        };
        
        // Minesweeper game variables
        let minesweeperGame = {
            grid: [],
            rows: 9,
            cols: 9,
            mines: 10,
            flags: 0,
            revealed: 0,
            gameOver: false,
            gameWon: false,
            timer: null,
            time: 0,
            firstClick: true,
            difficulty: 'beginner'
        };
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            // Startup sound
            try {
                document.getElementById('win95-startup-sound').play().catch(() => {
                    console.log('Autoplay prevented by browser');
                });
            } catch (e) {
                console.log('Audio not supported');
            }
            
            // Close startup screen after loading
            setTimeout(() => {
                document.querySelector('.win95-startup').classList.add('hidden');
                
                // Initialize the clock
                updateClock();
                setInterval(updateClock, 60000);
                
                // Initialize memory display
                updateMemoryDisplay();
                
                // Show tip of the day
                setTimeout(() => {
                    showTipOfTheDay();
                }, 1000);
            }, 3000);
            
            // Initialize event listeners
            initializeEventListeners();
            
            // Initialize Minesweeper
            initializeMinesweeper();
        });
        
        // Initialize all event listeners
        function initializeEventListeners() {
            // Start button
            document.getElementById('start-button').addEventListener('click', toggleStartMenu);
            
            // Desktop icons
            document.getElementById('my-computer-icon').addEventListener('dblclick', openMyComputerWindow);
            document.getElementById('github-icon').addEventListener('dblclick', openExplorerWindow);
            document.getElementById('minesweeper-icon').addEventListener('dblclick', openMinesweeperWindow);
            document.getElementById('notepad-icon').addEventListener('dblclick', openNotepadWindow);
            document.getElementById('internet-explorer-icon').addEventListener('dblclick', openInternetExplorer);
            
            // Desktop context menu
            document.querySelector('.win95-desktop').addEventListener('contextmenu', (e) => {
                if (!e.target.closest('.win95-desktop-icon')) {
                    e.preventDefault();
                    
                    // Show desktop context menu
                    const contextMenu = document.getElementById('desktop-context-menu');
                    contextMenu.style.display = 'block';
                    contextMenu.style.left = e.pageX + 'px';
                    contextMenu.style.top = e.pageY + 'px';
                    
                    // Hide context menu when clicking outside
                    document.addEventListener('click', hideContextMenus);
                }
            });
            
            // Start menu items
            document.getElementById('start-explorer').addEventListener('click', () => {
                openExplorerWindow();
                hideStartMenu();
            });
            
            document.getElementById('start-minesweeper').addEventListener('click', () => {
                openMinesweeperWindow();
                hideStartMenu();
            });
            
            document.getElementById('start-notepad').addEventListener('click', () => {
                openNotepadWindow();
                hideStartMenu();
            });
            
            document.getElementById('start-internet-explorer').addEventListener('click', () => {
                openInternetExplorer();
                hideStartMenu();
            });
            
            document.getElementById('start-run').addEventListener('click', () => {
                openRunDialog();
                hideStartMenu();
            });
            
            document.getElementById('start-shutdown').addEventListener('click', () => {
                showShutdownDialog();
                hideStartMenu();
            });
            
            // Explorer window buttons
            document.getElementById('explorer-minimize').addEventListener('click', () => minimizeWindow('explorer'));
            document.getElementById('explorer-maximize').addEventListener('click', () => maximizeWindow('explorer'));
            document.getElementById('explorer-close').addEventListener('click', () => closeWindow('explorer'));
            document.getElementById('menu-close').addEventListener('click', () => closeWindow('explorer'));
            
            // Minesweeper window buttons
            document.getElementById('minesweeper-minimize').addEventListener('click', () => minimizeWindow('minesweeper'));
            document.getElementById('minesweeper-close').addEventListener('click', () => closeWindow('minesweeper'));
            document.getElementById('minesweeper-exit').addEventListener('click', () => closeWindow('minesweeper'));
            
            // Notepad window buttons
            document.getElementById('notepad-minimize').addEventListener('click', () => minimizeWindow('notepad'));
            document.getElementById('notepad-maximize').addEventListener('click', () => maximizeWindow('notepad'));
            document.getElementById('notepad-close').addEventListener('click', () => closeWindow('notepad'));
            document.getElementById('notepad-exit').addEventListener('click', () => closeWindow('notepad'));
            
            // My Computer window buttons
            document.getElementById('my-computer-minimize').addEventListener('click', () => minimizeWindow('my-computer'));
            document.getElementById('my-computer-maximize').addEventListener('click', () => maximizeWindow('my-computer'));
            document.getElementById('my-computer-close').addEventListener('click', () => closeWindow('my-computer'));
            document.getElementById('my-computer-close-menu').addEventListener('click', () => closeWindow('my-computer'));
            
            // Window title bars for dragging
            initializeWindowDrag('explorer-title-bar', 'explorer-window');
            initializeWindowDrag('minesweeper-title-bar', 'minesweeper-window');
            initializeWindowDrag('notepad-title-bar', 'notepad-window');
            initializeWindowDrag('my-computer-title-bar', 'my-computer-window');
            
            // View options in Explorer
            document.getElementById('view-large-icons').addEventListener('click', () => setViewMode('large'));
            document.getElementById('view-small-icons').addEventListener('click', () => setViewMode('small'));
            document.getElementById('view-list').addEventListener('click', () => setViewMode('list'));
            document.getElementById('view-details').addEventListener('click', () => setViewMode('details'));
            
            // Sort options in Explorer
            document.getElementById('arrange-by-name').addEventListener('click', () => sortRepositories('name'));
            document.getElementById('arrange-by-type').addEventListener('click', () => sortRepositories('language'));
            document.getElementById('arrange-by-size').addEventListener('click', () => sortRepositories('size'));
            document.getElementById('arrange-by-date').addEventListener('click', () => sortRepositories('updated'));
            
            // Explorer toolbar buttons
            document.getElementById('view-button').addEventListener('click', cycleViewMode);
            document.getElementById('refresh-repos').addEventListener('click', fetchRepositories);
            
            // Run dialog buttons
            document.getElementById('run-close').addEventListener('click', closeRunDialog);
            document.getElementById('run-cancel').addEventListener('click', closeRunDialog);
            document.getElementById('run-ok').addEventListener('click', executeRunCommand);
            
            // About dialog buttons
            document.getElementById('menu-about').addEventListener('click', showAboutModal);
            document.getElementById('about-close').addEventListener('click', hideAboutModal);
            document.getElementById('about-ok').addEventListener('click', hideAboutModal);
            
            // Repository properties dialog
            document.getElementById('modal-close').addEventListener('click', hideRepoPropertiesModal);
            
            // Common dialog buttons
            document.getElementById('dialog-ok').addEventListener('click', hideDialog);
            document.getElementById('dialog-close').addEventListener('click', hideDialog);
            document.getElementById('dialog-cancel').addEventListener('click', hideDialog);
            document.getElementById('dialog-yes').addEventListener('click', hideDialog);
            document.getElementById('dialog-no').addEventListener('click', hideDialog);
            
            // Minesweeper game
            document.getElementById('new-game').addEventListener('click', resetMinesweeperGame);
            document.getElementById('beginner').addEventListener('click', () => changeMinesweeperDifficulty('beginner'));
            document.getElementById('intermediate').addEventListener('click', () => changeMinesweeperDifficulty('intermediate'));
            document.getElementById('expert').addEventListener('click', () => changeMinesweeperDifficulty('expert'));
            document.getElementById('minesweeper-face').addEventListener('click', resetMinesweeperGame);
            
            // Context menu items
            document.getElementById('context-open').addEventListener('click', () => {
                if (selectedRepo) {
                    showRepoProperties(selectedRepo);
                }
                hideContextMenus();
            });
            
            document.getElementById('context-view-github').addEventListener('click', () => {
                if (selectedRepo) {
                    window.open(selectedRepo.html_url, '_blank');
                }
                hideContextMenus();
            });
            
            document.getElementById('context-copy-url').addEventListener('click', () => {
                if (selectedRepo) {
                    navigator.clipboard.writeText(selectedRepo.html_url).then(() => {
                        showStatusMessage('URL copied to clipboard');
                    }).catch(err => {
                        console.error('Could not copy text: ', err);
                    });
                }
                hideContextMenus();
            });
            
            document.getElementById('context-properties').addEventListener('click', () => {
                if (selectedRepo) {
                    showRepoProperties(selectedRepo);
                }
                hideContextMenus();
            });
            
            // Desktop context menu items
            document.getElementById('desktop-refresh').addEventListener('click', () => {
                hideContextMenus();
                location.reload();
            });
            
            // Clicks on windows to make them active
            document.getElementById('explorer-window').addEventListener('mousedown', () => {
                makeWindowActive('explorer');
            });
            
            document.getElementById('minesweeper-window').addEventListener('mousedown', () => {
                makeWindowActive('minesweeper');
            });
            
            document.getElementById('notepad-window').addEventListener('mousedown', () => {
                makeWindowActive('notepad');
            });
            
            document.getElementById('my-computer-window').addEventListener('mousedown', () => {
                makeWindowActive('my-computer');
            });
            
            // Modal background closes modals
            document.getElementById('modal-background').addEventListener('click', () => {
                hideAllModals();
                hideStartMenu();
            });
            
            // Close Start Menu when clicking on desktop
            document.addEventListener('click', (e) => {
                if (isStartMenuOpen && !e.target.closest('#start-menu') && !e.target.closest('#start-button')) {
                    hideStartMenu();
                }
            });
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                // Alt+Tab - cycle through windows
                if (e.key === 'Tab' && e.altKey) {
                    e.preventDefault();
                    cycleThroughWindows();
                }
                
                // F5 - refresh if explorer is active
                if (e.key === 'F5' && windows.explorer.isActive) {
                    e.preventDefault();
                    fetchRepositories();
                }
                
                // Alt+F4 - close active window
                if (e.key === 'F4' && e.altKey) {
                    e.preventDefault();
                    for (const id in windows) {
                        if (windows[id].isOpen && windows[id].isActive) {
                            closeWindow(id);
                            break;
                        }
                    }
                }
                
                // Escape - close dialogs, start menu
                if (e.key === 'Escape') {
                    hideAllModals();
                    hideStartMenu();
                    hideContextMenus();
                }
                
                // Ctrl+Esc - toggle start menu
                if (e.key === 'Escape' && e.ctrlKey) {
                    e.preventDefault();
                    toggleStartMenu();
                }
            });
        }
        
        // Initialize window dragging
        function initializeWindowDrag(titleBarId, windowId) {
            const titleBar = document.getElementById(titleBarId);
            const window = document.getElementById(windowId);
            
            titleBar.addEventListener('mousedown', (e) => {
                if (e.target.classList.contains('win95-window-button')) return;
                
                isDragging = true;
                const rect = window.getBoundingClientRect();
                dragOffsetX = e.clientX - rect.left;
                dragOffsetY = e.clientY - rect.top;
                
                window.style.opacity = '0.8';
                
                // Make this window active
                if (windowId === 'explorer-window') {
                    makeWindowActive('explorer');
                } else if (windowId === 'minesweeper-window') {
                    makeWindowActive('minesweeper');
                } else if (windowId === 'notepad-window') {
                    makeWindowActive('notepad');
                } else if (windowId === 'my-computer-window') {
                    makeWindowActive('my-computer');
                }
            });
            
            document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    window.style.left = (e.clientX - dragOffsetX) + 'px';
                    window.style.top = (e.clientY - dragOffsetY) + 'px';
                }
            });
            
            document.addEventListener('mouseup', () => {
                if (isDragging) {
                    isDragging = false;
                    window.style.opacity = '1';
                }
            });
        }
        
        // Initialize Minesweeper
        function initializeMinesweeper() {
            const grid = document.getElementById('minesweeper-grid');
            setMinesweeperDifficulty('beginner');
        }
        
        // Set Minesweeper difficulty
        function setMinesweeperDifficulty(difficulty) {
            minesweeperGame.difficulty = difficulty;
            
            switch (difficulty) {
                case 'beginner':
                    minesweeperGame.rows = 9;
                    minesweeperGame.cols = 9;
                    minesweeperGame.mines = 10;
                    document.querySelector('.minesweeper-window').style.width = '200px';
                    document.querySelector('.minesweeper-window').style.height = '300px';
                    break;
                case 'intermediate':
                    minesweeperGame.rows = 16;
                    minesweeperGame.cols = 16;
                    minesweeperGame.mines = 40;
                    document.querySelector('.minesweeper-window').style.width = '300px';
                    document.querySelector('.minesweeper-window').style.height = '400px';
                    break;
                case 'expert':
                    minesweeperGame.rows = 16;
                    minesweeperGame.cols = 30;
                    minesweeperGame.mines = 99;
                    document.querySelector('.minesweeper-window').style.width = '500px';
                    document.querySelector('.minesweeper-window').style.height = '400px';
                    break;
            }
            
            resetMinesweeperGame();
        }
        
        // Change Minesweeper difficulty
        function changeMinesweeperDifficulty(difficulty) {
            playSound('click');
            setMinesweeperDifficulty(difficulty);
        }
        
        // Reset Minesweeper game
        function resetMinesweeperGame() {
            playSound('click');
            minesweeperGame.grid = [];
            minesweeperGame.flags = 0;
            minesweeperGame.revealed = 0;
            minesweeperGame.gameOver = false;
            minesweeperGame.gameWon = false;
            minesweeperGame.firstClick = true;
            minesweeperGame.time = 0;
            
            // Reset face
            document.getElementById('minesweeper-face').innerHTML = '😊';
            
            // Reset counters
            document.getElementById('mines-counter').textContent = minesweeperGame.mines.toString().padStart(3, '0');
            document.getElementById('time-counter').textContent = '000';
            
            // Clear timer
            if (minesweeperGame.timer) {
                clearInterval(minesweeperGame.timer);
                minesweeperGame.timer = null;
            }
            
            // Initialize grid
            initializeMinesweeperGrid();
        }
        
        // Initialize Minesweeper grid
        function initializeMinesweeperGrid() {
            const grid = document.getElementById('minesweeper-grid');
            grid.innerHTML = '';
            grid.style.gridTemplateColumns = `repeat(${minesweeperGame.cols}, 1fr)`;
            grid.style.gridTemplateRows = `repeat(${minesweeperGame.rows}, 1fr)`;
            
            // Create empty grid
            for (let row = 0; row < minesweeperGame.rows; row++) {
                minesweeperGame.grid[row] = [];
                for (let col = 0; col < minesweeperGame.cols; col++) {
                    minesweeperGame.grid[row][col] = {
                        isMine: false,
                        isRevealed: false,
                        isFlagged: false,
                        neighbors: 0
                    };
                    
                    const cell = document.createElement('div');
                    cell.className = 'minesweeper-cell';
                    cell.dataset.row = row;
                    cell.dataset.col = col;
                    
                    // Left click to reveal
                    cell.addEventListener('click', (e) => {
                        if (minesweeperGame.gameOver) return;
                        if (minesweeperGame.grid[row][col].isFlagged) return;
                        
                        // First click
                        if (minesweeperGame.firstClick) {
                            placeMines(row, col);
                            startTimer();
                            minesweeperGame.firstClick = false;
                        }
                        
                        revealCell(row, col);
                        
                        // Check if game is won
                        checkWinCondition();
                    });
                    
                    // Right click to flag
                    cell.addEventListener('contextmenu', (e) => {
                        e.preventDefault();
                        if (minesweeperGame.gameOver) return;
                        if (minesweeperGame.grid[row][col].isRevealed) return;
                        
                        toggleFlag(row, col);
                    });
                    
                    grid.appendChild(cell);
                }
            }
        }
        
        // Place mines on the grid (avoiding the first clicked cell)
        function placeMines(clickedRow, clickedCol) {
            let minesPlaced = 0;
            
            while (minesPlaced < minesweeperGame.mines) {
                const row = Math.floor(Math.random() * minesweeperGame.rows);
                const col = Math.floor(Math.random() * minesweeperGame.cols);
                
                // Don't place mine on first clicked cell or where there's already a mine
                if ((row === clickedRow && col === clickedCol) || minesweeperGame.grid[row][col].isMine) {
                    continue;
                }
                
                minesweeperGame.grid[row][col].isMine = true;
                minesPlaced++;
                
                // Increment neighbor counts
                for (let r = Math.max(0, row - 1); r <= Math.min(minesweeperGame.rows - 1, row + 1); r++) {
                    for (let c = Math.max(0, col - 1); c <= Math.min(minesweeperGame.cols - 1, col + 1); c++) {
                        if (r === row && c === col) continue;
                        minesweeperGame.grid[r][c].neighbors++;
                    }
                }
            }
        }
        
        // Start the timer
        function startTimer() {
            minesweeperGame.timer = setInterval(() => {
                minesweeperGame.time++;
                if (minesweeperGame.time > 999) minesweeperGame.time = 999;
                document.getElementById('time-counter').textContent = minesweeperGame.time.toString().padStart(3, '0');
            }, 1000);
        }
        
        // Toggle flag on a cell
        function toggleFlag(row, col) {
            const cell = minesweeperGame.grid[row][col];
            const element = document.querySelector(`.minesweeper-cell[data-row="${row}"][data-col="${col}"]`);
            
            if (cell.isFlagged) {
                cell.isFlagged = false;
                element.classList.remove('flagged');
                minesweeperGame.flags--;
            } else {
                if (minesweeperGame.flags < minesweeperGame.mines) {
                    cell.isFlagged = true;
                    element.classList.add('flagged');
                    minesweeperGame.flags++;
                }
            }
            
            // Update mines counter
            document.getElementById('mines-counter').textContent = (minesweeperGame.mines - minesweeperGame.flags).toString().padStart(3, '0');
        }
        
        // Reveal a cell
        function revealCell(row, col) {
            const cell = minesweeperGame.grid[row][col];
            
            // Skip if already revealed or flagged
            if (cell.isRevealed || cell.isFlagged) return;
            
            cell.isRevealed = true;
            minesweeperGame.revealed++;
            
            const element = document.querySelector(`.minesweeper-cell[data-row="${row}"][data-col="${col}"]`);
            element.classList.add('revealed');
            
            // If it's a mine, game over
            if (cell.isMine) {
                element.classList.add('mine-clicked');
                gameOver(false);
                return;
            }
            
            // If it has neighbors, show the number
            if (cell.neighbors > 0) {
                element.classList.add(`number-${cell.neighbors}`);
                element.textContent = cell.neighbors;
            } else {
                // If it's an empty cell, reveal neighbors
                for (let r = Math.max(0, row - 1); r <= Math.min(minesweeperGame.rows - 1, row + 1); r++) {
                    for (let c = Math.max(0, col - 1); c <= Math.min(minesweeperGame.cols - 1, col + 1); c++) {
                        if (r === row && c === col) continue;
                        revealCell(r, c);
                    }
                }
            }
        }
        
        // Check if the game is won
        function checkWinCondition() {
            const totalCells = minesweeperGame.rows * minesweeperGame.cols;
            const cellsToReveal = totalCells - minesweeperGame.mines;
            
            if (minesweeperGame.revealed === cellsToReveal) {
                gameOver(true);
            }
        }
        
        // Game over
        function gameOver(isWin) {
            minesweeperGame.gameOver = true;
            
            // Stop timer
            if (minesweeperGame.timer) {
                clearInterval(minesweeperGame.timer);
                minesweeperGame.timer = null;
            }
            
            // Update face
            document.getElementById('minesweeper-face').innerHTML = isWin ? '😎' : '😵';
            
            if (isWin) {
                // Flag all mines
                for (let row = 0; row < minesweeperGame.rows; row++) {
                    for (let col = 0; col < minesweeperGame.cols; col++) {
                        if (minesweeperGame.grid[row][col].isMine && !minesweeperGame.grid[row][col].isFlagged) {
                            toggleFlag(row, col);
                        }
                    }
                }
                
                playSound('click');
                showDialog('Game Won', 'Congratulations! You won the game!', 'info');
            } else {
                // Reveal all mines
                for (let row = 0; row < minesweeperGame.rows; row++) {
                    for (let col = 0; col < minesweeperGame.cols; col++) {
                        const cell = minesweeperGame.grid[row][col];
                        if (cell.isMine && !cell.isRevealed) {
                            const element = document.querySelector(`.minesweeper-cell[data-row="${row}"][data-col="${col}"]`);
                            if (!cell.isFlagged) {
                                element.classList.add('revealed');
                                element.classList.add('mine');
                            }
                        } else if (cell.isFlagged && !cell.isMine) {
                            // Wrong flag
                            const element = document.querySelector(`.minesweeper-cell[data-row="${row}"][data-col="${col}"]`);
                            element.classList.add('revealed');
                            element.innerHTML = '❌';
                        }
                    }
                }
                
                playSound('error');
                showDialog('Game Over', 'You hit a mine! Game over.', 'error');
            }
        }
        
        // Update the clock in the taskbar
        function updateClock() {
            const now = new Date();
            let hours = now.getHours();
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const ampm = hours >= 12 ? 'PM' : 'AM';
            
            hours = hours % 12;
            hours = hours ? hours : 12; // Convert 0 to 12
            
            document.getElementById('taskbar-clock').textContent = `${hours}:${minutes} ${ampm}`;
        }
        
        // Update memory display
        function updateMemoryDisplay() {
            const memoryDisplay = document.getElementById('memory-display');
            const memory = Math.floor(Math.random() * 100) + 10;
            memoryDisplay.textContent = `${memory}.${Math.floor(Math.random() * 100)}MB free`;
        }
        
        // Toggle Start Menu
        function toggleStartMenu() {
            playSound('click');
            
            const startMenu = document.getElementById('start-menu');
            const startButton = document.getElementById('start-button');
            
            if (isStartMenuOpen) {
                startMenu.classList.remove('active');
                startButton.classList.remove('active');
                isStartMenuOpen = false;
            } else {
                startMenu.classList.add('active');
                startButton.classList.add('active');
                isStartMenuOpen = true;
            }
        }
        
        // Hide Start Menu
        function hideStartMenu() {
            const startMenu = document.getElementById('start-menu');
            const startButton = document.getElementById('start-button');
            
            startMenu.classList.remove('active');
            startButton.classList.remove('active');
            isStartMenuOpen = false;
        }
        
        // Open Explorer Window
        function openExplorerWindow() {
            playSound('click');
            
            const window = document.getElementById('explorer-window');
            window.style.display = 'block';
            
            windows.explorer.isOpen = true;
            windows.explorer.isMinimized = false;
            
            makeWindowActive('explorer');
            updateTaskbar();
            
            // Fetch repositories if this is the first time opening
            if (allRepos.length === 0) {
                fetchRepositories();
            }
        }
        
        // Open Minesweeper Window
        function openMinesweeperWindow() {
            playSound('click');
            
            const window = document.getElementById('minesweeper-window');
            window.style.display = 'block';
            
            windows.minesweeper.isOpen = true;
            windows.minesweeper.isMinimized = false;
            
            makeWindowActive('minesweeper');
            updateTaskbar();
            
            // Reset game if needed
            if (minesweeperGame.gameOver) {
                resetMinesweeperGame();
            }
        }
        
        // Open Notepad window
        function openNotepadWindow() {
            playSound('click');
            
            const window = document.getElementById('notepad-window');
            window.style.display = 'block';
            
            windows.notepad.isOpen = true;
            windows.notepad.isMinimized = false;
            
            makeWindowActive('notepad');
            updateTaskbar();
        }
        
        // Open My Computer window
        function openMyComputerWindow() {
            playSound('click');
            
            const window = document.getElementById('my-computer-window');
            window.style.display = 'block';
            
            windows['my-computer'].isOpen = true;
            windows['my-computer'].isMinimized = false;
            
            makeWindowActive('my-computer');
            updateTaskbar();
        }
        
        // Open Internet Explorer
        function openInternetExplorer() {
            playSound('click');
            showDialog('Internet Explorer', 'Internet Explorer is not available in this version of Windows 95.', 'info');
        }
        
        // Open Run dialog
        function openRunDialog() {
            playSound('click');
            document.getElementById('run-dialog').style.display = 'block';
            document.getElementById('run-command').focus();
            document.getElementById('modal-background').style.display = 'block';
        }
        
        // Close Run dialog
        function closeRunDialog() {
            playSound('click');
            document.getElementById('run-dialog').style.display = 'none';
            document.getElementById('modal-background').style.display = 'none';
            document.getElementById('run-command').value = '';
        }
        
        // Execute Run command
        function executeRunCommand() {
            const command = document.getElementById('run-command').value.trim().toLowerCase();
            
            closeRunDialog();
            
            if (command === 'notepad' || command === 'notepad.exe') {
                openNotepadWindow();
            } else if (command === 'explorer' || command === 'explorer.exe') {
                openExplorerWindow();
            } else if (command === 'minesweeper' || command === 'winmine.exe') {
                openMinesweeperWindow();
            } else if (command === 'iexplore' || command === 'iexplore.exe') {
                openInternetExplorer();
            } else if (command === '') {
                // Do nothing for empty command
            } else {
                showDialog('Windows', `Cannot find the file '${command}' (or one of its components). Make sure the path and filename are correct and that all required libraries are available.`, 'error');
            }
        }
        
        // Make a window active (bring to front)
        function makeWindowActive(windowId) {
            // Deactivate all windows
            for (const id in windows) {
                windows[id].isActive = false;
                
                if (id === 'explorer') {
                    document.getElementById('explorer-window').querySelector('.win95-title-bar').classList.add('inactive');
                    document.getElementById('explorer-window').style.zIndex = '10';
                } else if (id === 'minesweeper') {
                    document.getElementById('minesweeper-window').querySelector('.win95-title-bar').classList.add('inactive');
                    document.getElementById('minesweeper-window').style.zIndex = '10';
                } else if (id === 'notepad') {
                    document.getElementById('notepad-window').querySelector('.win95-title-bar').classList.add('inactive');
                    document.getElementById('notepad-window').style.zIndex = '10';
                } else if (id === 'my-computer') {
                    document.getElementById('my-computer-window').querySelector('.win95-title-bar').classList.add('inactive');
                    document.getElementById('my-computer-window').style.zIndex = '10';
                }
            }
            
            // Activate the selected window
            windows[windowId].isActive = true;
            
            if (windowId === 'explorer') {
                document.getElementById('explorer-window').querySelector('.win95-title-bar').classList.remove('inactive');
                document.getElementById('explorer-window').style.zIndex = '100';
            } else if (windowId === 'minesweeper') {
                document.getElementById('minesweeper-window').querySelector('.win95-title-bar').classList.remove('inactive');
                document.getElementById('minesweeper-window').style.zIndex = '100';
            } else if (windowId === 'notepad') {
                document.getElementById('notepad-window').querySelector('.win95-title-bar').classList.remove('inactive');
                document.getElementById('notepad-window').style.zIndex = '100';
            } else if (windowId === 'my-computer') {
                document.getElementById('my-computer-window').querySelector('.win95-title-bar').classList.remove('inactive');
                document.getElementById('my-computer-window').style.zIndex = '100';
            }
            
            updateTaskbar();
        }
        
        // Cycle through open windows (Alt+Tab functionality)
        function cycleThroughWindows() {
            const openWindows = [];
            
            // Collect all open windows
            for (const id in windows) {
                if (windows[id].isOpen && !windows[id].isMinimized) {
                    openWindows.push(id);
                }
            }
            
            if (openWindows.length === 0) return;
            
            // Find the currently active window
            let activeIndex = openWindows.findIndex(id => windows[id].isActive);
            
            // Move to the next window (or first if none is active)
            activeIndex = (activeIndex + 1) % openWindows.length;
            
            makeWindowActive(openWindows[activeIndex]);
        }
        
        // Minimize a window
        function minimizeWindow(windowId) {
            playSound('click');
            
            windows[windowId].isMinimized = true;
            
            if (windowId === 'explorer') {
                document.getElementById('explorer-window').style.display = 'none';
            } else if (windowId === 'minesweeper') {
                document.getElementById('minesweeper-window').style.display = 'none';
            } else if (windowId === 'notepad') {
                document.getElementById('notepad-window').style.display = 'none';
            } else if (windowId === 'my-computer') {
                document.getElementById('my-computer-window').style.display = 'none';
            }
            
            updateTaskbar();
            
            // Make another window active if available
            for (const id in windows) {
                if (windows[id].isOpen && !windows[id].isMinimized) {
                    makeWindowActive(id);
                    break;
                }
            }
        }
        
        // Maximize a window
        function maximizeWindow(windowId) {
            playSound('click');
            
            const window = document.getElementById(`${windowId}-window`);
            
            if (window.style.width === '100%') {
                // Restore from maximized
                if (windowId === 'explorer') {
                    window.style.width = '600px';
                    window.style.height = '400px';
                    window.style.top = '50px';
                    window.style.left = '50px';
                } else if (windowId === 'minesweeper') {
                    if (minesweeperGame.difficulty === 'beginner') {
                        window.style.width = '200px';
                        window.style.height = '300px';
                    } else if (minesweeperGame.difficulty === 'intermediate') {
                        window.style.width = '300px';
                        window.style.height = '400px';
                    } else {
                        window.style.width = '500px';
                        window.style.height = '400px';
                    }
                    window.style.top = '100px';
                    window.style.left = '300px';
                } else if (windowId === 'notepad') {
                    window.style.width = '500px';
                    window.style.height = '400px';
                    window.style.top = '70px';
                    window.style.left = '120px';
                } else if (windowId === 'my-computer') {
                    window.style.width = '600px';
                    window.style.height = '400px';
                    window.style.top = '60px';
                    window.style.left = '80px';
                }
            } else {
                // Maximize
                window.style.width = '100%';
                window.style.height = 'calc(100% - 28px)';
                window.style.top = '0';
                window.style.left = '0';
            }
        }
        
        // Close a window
        function closeWindow(windowId) {
            playSound('click');
            
            // Special case for notepad - check for unsaved changes
            if (windowId === 'notepad') {
                const textarea = document.getElementById('notepad-textarea');
                if (textarea.value.trim() !== '') {
                    showConfirmDialog('Notepad', 'Do you want to save changes?', (result) => {
                        if (result) {
                            // For simplicity, we'll just clear the textarea
                            textarea.value = '';
                        }
                        // Actually close the window
                        closeWindowNow(windowId);
                    });
                    return;
                }
            }
            
            closeWindowNow(windowId);
        }
        
        // Actually close the window
        function closeWindowNow(windowId) {
            windows[windowId].isOpen = false;
            windows[windowId].isMinimized = false;
            windows[windowId].isActive = false;
            
            if (windowId === 'explorer') {
                document.getElementById('explorer-window').style.display = 'none';
            } else if (windowId === 'minesweeper') {
                document.getElementById('minesweeper-window').style.display = 'none';
                
                // Stop the minesweeper timer
                if (minesweeperGame.timer) {
                    clearInterval(minesweeperGame.timer);
                    minesweeperGame.timer = null;
                }
            } else if (windowId === 'notepad') {
                document.getElementById('notepad-window').style.display = 'none';
            } else if (windowId === 'my-computer') {
                document.getElementById('my-computer-window').style.display = 'none';
            }
            
            updateTaskbar();
            
            // Make another window active if available
            for (const id in windows) {
                if (windows[id].isOpen && !windows[id].isMinimized) {
                    makeWindowActive(id);
                    break;
                }
            }
        }
        
        // Update taskbar
        function updateTaskbar() {
            const taskbarItems = document.getElementById('taskbar-items');
            taskbarItems.innerHTML = '';
            
            // Add explorer window button if open
            if (windows.explorer.isOpen) {
                const button = document.createElement('div');
                button.className = `win95-taskbar-item ${windows.explorer.isActive ? 'active' : 'inactive'}`;
                button.innerHTML = '<i class="fab fa-github"></i> GitHub Explorer';
                
                button.addEventListener('click', () => {
                    if (windows.explorer.isMinimized) {
                        windows.explorer.isMinimized = false;
                        document.getElementById('explorer-window').style.display = 'block';
                        makeWindowActive('explorer');
                    } else if (windows.explorer.isActive) {
                        minimizeWindow('explorer');
                    } else {
                        makeWindowActive('explorer');
                    }
                });
                
                taskbarItems.appendChild(button);
            }
            
            // Add minesweeper window button if open
            if (windows.minesweeper.isOpen) {
                const button = document.createElement('div');
                button.className = `win95-taskbar-item ${windows.minesweeper.isActive ? 'active' : 'inactive'}`;
                button.innerHTML = '<i class="fas fa-bomb"></i> Minesweeper';
                
                button.addEventListener('click', () => {
                    if (windows.minesweeper.isMinimized) {
                        windows.minesweeper.isMinimized = false;
                        document.getElementById('minesweeper-window').style.display = 'block';
                        makeWindowActive('minesweeper');
                    } else if (windows.minesweeper.isActive) {
                        minimizeWindow('minesweeper');
                    } else {
                        makeWindowActive('minesweeper');
                    }
                });
                
                taskbarItems.appendChild(button);
            }
            
            // Add notepad window button if open
            if (windows.notepad.isOpen) {
                const button = document.createElement('div');
                button.className = `win95-taskbar-item ${windows.notepad.isActive ? 'active' : 'inactive'}`;
                button.innerHTML = '<i class="fas fa-sticky-note"></i> Notepad';
                
                button.addEventListener('click', () => {
                    if (windows.notepad.isMinimized) {
                        windows.notepad.isMinimized = false;
                        document.getElementById('notepad-window').style.display = 'block';
                        makeWindowActive('notepad');
                    } else if (windows.notepad.isActive) {
                        minimizeWindow('notepad');
                    } else {
                        makeWindowActive('notepad');
                    }
                });
                
                taskbarItems.appendChild(button);
            }
            
            // Add My Computer window button if open
            if (windows['my-computer'].isOpen) {
                const button = document.createElement('div');
                button.className = `win95-taskbar-item ${windows['my-computer'].isActive ? 'active' : 'inactive'}`;
                button.innerHTML = '<i class="fas fa-desktop"></i> My Computer';
                
                button.addEventListener('click', () => {
                    if (windows['my-computer'].isMinimized) {
                        windows['my-computer'].isMinimized = false;
                        document.getElementById('my-computer-window').style.display = 'block';
                        makeWindowActive('my-computer');
                    } else if (windows['my-computer'].isActive) {
                        minimizeWindow('my-computer');
                    } else {
                        makeWindowActive('my-computer');
                    }
                });
                
                taskbarItems.appendChild(button);
            }
        }
        
        // Set view mode for repository display
        function setViewMode(mode) {
            playSound('click');
            currentView = mode;
            
            const repoGrid = document.querySelector('.win95-repo-grid');
            if (!repoGrid) return;
            
            // Clear existing class and set new one
            repoGrid.className = 'win95-repo-grid';
            repoGrid.classList.add(`win95-view-${mode}`);
            
            // Add details header for details view
            if (mode === 'details') {
                // Remove existing header if any
                const existingHeader = repoGrid.querySelector('.win95-details-header');
                if (existingHeader) {
                    repoGrid.removeChild(existingHeader);
                }
                
                // Create header
                const header = document.createElement('div');
                header.className = 'win95-details-header';
                header.innerHTML = `
                    <div class="win95-details-header-item">Name</div>
                    <div class="win95-details-header-item">Language</div>
                    <div class="win95-details-header-item">Size</div>
                    <div class="win95-details-header-item">Last Updated</div>
                    <div class="win95-details-header-item">Stars</div>
                `;
                
                repoGrid.insertBefore(header, repoGrid.firstChild);
            } else {
                // Remove header if not in details view
                const existingHeader = repoGrid.querySelector('.win95-details-header');
                if (existingHeader) {
                    repoGrid.removeChild(existingHeader);
                }
            }
            
            renderRepositories(allRepos);
        }
        
        // Cycle through view modes
        function cycleViewMode() {
            playSound('click');
            
            const modes = ['large', 'small', 'list', 'details'];
            const currentIndex = modes.indexOf(currentView);
            const nextIndex = (currentIndex + 1) % modes.length;
            setViewMode(modes[nextIndex]);
        }
        
        // Sort repositories
        function sortRepositories(sortType) {
            playSound('click');
            currentSort = sortType;
            
            allRepos.sort((a, b) => {
                switch (sortType) {
                    case 'name':
                        return a.name.localeCompare(b.name);
                    case 'updated':
                        return new Date(b.updated_at) - new Date(a.updated_at);
                    case 'language':
                        if (!a.language) return 1;
                        if (!b.language) return -1;
                        return a.language.localeCompare(b.language);
                    case 'size':
                        return b.size - a.size;
                    default:
                        return 0;
                }
            });
            
            renderRepositories(allRepos);
        }
        
        // Show the repository properties modal
        function showRepoProperties(repo) {
            playSound('click');
            
            const modal = document.getElementById('repo-properties-modal');
            const modalBg = document.getElementById('modal-background');
            const content = document.getElementById('repo-details-content');
            const modalTitle = document.getElementById('modal-repo-name');
            
            // Set title
            modalTitle.textContent = `${repo.name} Properties`;
            
            // Format dates
            const createdDate = new Date(repo.created_at).toLocaleDateString();
            const updatedDate = new Date(repo.updated_at).toLocaleDateString();
            
            // Prepare content
            content.innerHTML = `
                <div style="padding: 10px; border: 1px solid var(--win95-darker); margin-bottom: 10px; background-color: white;">
                    ${repo.description || "No description available."}
                </div>
                
                <div class="win95-modal-row">
                    <div class="win95-modal-label">Created:</div>
                    <div class="win95-modal-value">${createdDate}</div>
                </div>
                
                <div class="win95-modal-row">
                    <div class="win95-modal-label">Last Updated:</div>
                    <div class="win95-modal-value">${updatedDate}</div>
                </div>
                
                <div class="win95-modal-row">
                    <div class="win95-modal-label">Language:</div>
                    <div class="win95-modal-value">${repo.language || "Not specified"}</div>
                </div>
                
                <div class="win95-modal-row">
                    <div class="win95-modal-label">Stars:</div>
                    <div class="win95-modal-value">${repo.stargazers_count}</div>
                </div>
                
                <div class="win95-modal-row">
                    <div class="win95-modal-label">Forks:</div>
                    <div class="win95-modal-value">${repo.forks_count}</div>
                </div>
                
                <div class="win95-modal-row">
                    <div class="win95-modal-label">Watchers:</div>
                    <div class="win95-modal-value">${repo.watchers_count}</div>
                </div>
                
                <div class="win95-modal-row">
                    <div class="win95-modal-label">Size:</div>
                    <div class="win95-modal-value">${repo.size} KB</div>
                </div>
                
                <div class="win95-modal-row">
                    <div class="win95-modal-label">URL:</div>
                    <div class="win95-modal-value" style="word-break: break-all;">${repo.html_url}</div>
                </div>
                
                <div class="win95-modal-buttons">
                    <a href="${repo.html_url}" target="_blank" class="win95-button">Open in GitHub</a>
                    <button class="win95-button" onclick="hideRepoPropertiesModal()">Close</button>
                </div>
            `;
            
            // Show modal
            modal.style.display = 'block';
            modalBg.style.display = 'block';
        }
        
        // Hide the repository properties modal
        function hideRepoPropertiesModal() {
            playSound('click');
            document.getElementById('repo-properties-modal').style.display = 'none';
            document.getElementById('modal-background').style.display = 'none';
        }
        
        // Show the About modal
        function showAboutModal() {
            playSound('click');
            document.getElementById('about-modal').style.display = 'block';
            document.getElementById('modal-background').style.display = 'block';
        }
        
        // Hide the About modal
        function hideAboutModal() {
            playSound('click');
            document.getElementById('about-modal').style.display = 'none';
            document.getElementById('modal-background').style.display = 'none';
        }
        
        // Show dialog
        function showDialog(title, message, type = 'info') {
            const dialog = document.getElementById('common-dialog');
            const dialogTitle = document.getElementById('dialog-title');
            const dialogMessage = document.getElementById('dialog-message');
            const dialogIcon = document.getElementById('dialog-icon');
            const modalBg = document.getElementById('modal-background');
            
            // Set title and message
            dialogTitle.textContent = title;
            dialogMessage.textContent = message;
            
            // Set icon based on type
            if (type === 'error') {
                dialogIcon.innerHTML = '<i class="fas fa-times-circle" style="color: red;"></i>';
            } else if (type === 'warning') {
                dialogIcon.innerHTML = '<i class="fas fa-exclamation-triangle" style="color: #aa8800;"></i>';
            } else if (type === 'question') {
                dialogIcon.innerHTML = '<i class="fas fa-question-circle" style="color: blue;"></i>';
            } else {
                dialogIcon.innerHTML = '<i class="fas fa-info-circle" style="color: blue;"></i>';
            }
            
            // Show only OK button by default
            document.getElementById('dialog-ok').style.display = 'block';
            document.getElementById('dialog-cancel').style.display = 'none';
            document.getElementById('dialog-yes').style.display = 'none';
            document.getElementById('dialog-no').style.display = 'none';
            
            // Show dialog
            dialog.style.display = 'block';
            modalBg.style.display = 'block';
        }
        
        // Show confirmation dialog
        function showConfirmDialog(title, message, callback) {
            const dialog = document.getElementById('common-dialog');
            const dialogTitle = document.getElementById('dialog-title');
            const dialogMessage = document.getElementById('dialog-message');
            const dialogIcon = document.getElementById('dialog-icon');
            const modalBg = document.getElementById('modal-background');
            
            // Set title and message
            dialogTitle.textContent = title;
            dialogMessage.textContent = message;
            
            // Set icon
            dialogIcon.innerHTML = '<i class="fas fa-question-circle" style="color: blue;"></i>';
            
            // Show Yes/No buttons
            document.getElementById('dialog-ok').style.display = 'none';
            document.getElementById('dialog-cancel').style.display = 'none';
            document.getElementById('dialog-yes').style.display = 'block';
            document.getElementById('dialog-no').style.display = 'block';
            
            // Set up callback
            document.getElementById('dialog-yes').onclick = function() {
                hideDialog();
                if (callback) callback(true);
            };
            
            document.getElementById('dialog-no').onclick = function() {
                hideDialog();
                if (callback) callback(false);
            };
            
            // Show dialog
            dialog.style.display = 'block';
            modalBg.style.display = 'block';
        }
        
        // Show shutdown dialog
        function showShutdownDialog() {
            playSound('click');
            
            showConfirmDialog('Shut Down Windows', 'Are you sure you want to shut down your computer?', (result) => {
                if (result) {
                    shutdown();
                }
            });
        }
        
        // Hide dialog
        function hideDialog() {
            document.getElementById('common-dialog').style.display = 'none';
            document.getElementById('modal-background').style.display = 'none';
        }
        
        // Hide all modals
        function hideAllModals() {
            document.getElementById('repo-properties-modal').style.display = 'none';
            document.getElementById('about-modal').style.display = 'none';
            document.getElementById('common-dialog').style.display = 'none';
            document.getElementById('run-dialog').style.display = 'none';
            document.getElementById('modal-background').style.display = 'none';
        }
        
        // Hide all context menus
        function hideContextMenus() {
            document.querySelectorAll('.win95-context-menu').forEach(menu => {
                menu.style.display = 'none';
            });
        }
        
        // Show status message
        function showStatusMessage(message) {
            const statusElement = document.createElement('div');
            statusElement.style.position = 'fixed';
            statusElement.style.bottom = '40px';
            statusElement.style.left = '50%';
            statusElement.style.transform = 'translateX(-50%)';
            statusElement.style.backgroundColor = 'var(--win95-light)';
            statusElement.style.padding = '8px 16px';
            statusElement.style.border = '2px solid';
            statusElement.style.borderColor = 'var(--win95-lighter) var(--win95-darker) var(--win95-darker) var(--win95-lighter)';
            statusElement.style.zIndex = '2000';
            statusElement.textContent = message;
            
            document.body.appendChild(statusElement);
            
            setTimeout(() => {
                document.body.removeChild(statusElement);
            }, 2000);
        }
        
        // Show Tip of the Day
        function showTipOfTheDay() {
            const tips = [
                "To copy a file, drag it while holding the Ctrl key.",
                "Use the Run command to quickly start programs.",
                "Click the right mouse button to access context menus.",
                "Double-click on icons to open files and folders.",
                "Press Alt+Tab to switch between running programs.",
                "Press F5 to refresh the current window.",
                "You can customize your desktop by right-clicking on it.",
                "Use Alt+F4 to close the current application.",
                "Minimize windows by clicking the '_' button.",
                "Press Ctrl+Esc to open the Start menu."
            ];
            
            const randomTip = tips[Math.floor(Math.random() * tips.length)];
            
            const tipDialog = document.createElement('div');
            tipDialog.className = 'win95-window win95-common-dialog';
            tipDialog.style.width = '350px';
            tipDialog.style.position = 'absolute';
            tipDialog.style.top = '100px';
            tipDialog.style.left = '150px';
            tipDialog.style.zIndex = '10001';
            
            tipDialog.innerHTML = `
                <div class="win95-title-bar">
                    <div class="win95-title">Tip of the Day</div>
                    <div class="win95-buttons">
                        <div class="win95-window-button" id="tip-close">×</div>
                    </div>
                </div>
                
                <div class="win95-window-content" style="position: static; bottom: auto; height: auto;">
                    <div class="win95-common-dialog-content">
                        <div style="display: flex; align-items: start; margin-bottom: 15px;">
                            <div style="font-size: 32px; margin-right: 10px; color: var(--win95-blue);">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <div>
                                <div style="font-weight: bold; margin-bottom: 5px;">Did you know...</div>
                                <div>${randomTip}</div>
                            </div>
                        </div>
                        
                        <div class="win95-common-dialog-buttons">
                            <div style="display: flex; align-items: center;">
                                <input type="checkbox" id="show-tips" checked>
                                <label for="show-tips" style="margin-left: 5px;">Show Tips at Startup</label>
                            </div>
                            <div>
                                <button class="win95-button" id="tip-next">Next Tip</button>
                                <button class="win95-button" id="tip-close-button">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(tipDialog);
            
            // Add event listeners
            document.getElementById('tip-close').addEventListener('click', () => {
                document.body.removeChild(tipDialog);
            });
            
            document.getElementById('tip-close-button').addEventListener('click', () => {
                document.body.removeChild(tipDialog);
            });
            
            document.getElementById('tip-next').addEventListener('click', () => {
                document.body.removeChild(tipDialog);
                showTipOfTheDay();
            });
        }
        
        // Play system sounds
        function playSound(type) {
            try {
                switch (type) {
                    case 'startup':
                        document.getElementById('win95-startup-sound').play().catch(() => {});
                        break;
                    case 'error':
                        document.getElementById('win95-error-sound').play().catch(() => {});
                        break;
                    case 'click':
                        document.getElementById('win95-click-sound').currentTime = 0;
                        document.getElementById('win95-click-sound').play().catch(() => {});
                        break;
                }
            } catch (e) {
                console.log('Audio not supported');
            }
        }
        
        // Fetch GitHub repositories
        async function fetchRepositories() {
            const username = 'Swir';
            const reposContainer = document.getElementById('repos-container');
            
            // Change container content to loading screen
            reposContainer.innerHTML = `
                <div class="win95-loading" style="width: 100%; text-align: center; padding: 50px;">
                    <img src="/api/placeholder/32/32" alt="Loading..." style="margin-bottom: 10px;">
                    <div>Loading repositories...</div>
                </div>
            `;
            
            try {
                const response = await fetch(`https://api.github.com/users/${username}/repos?per_page=100`);
                
                if (!response.ok) {
                    throw new Error(`GitHub API responded with status: ${response.status}`);
                }
                
                allRepos = await response.json();
                
                // Sort repositories
                sortRepositories(currentSort);
                
                // Update repository count
                document.getElementById('repo-count').textContent = `${allRepos.length} object(s)`;
                
                // Update memory display
                updateMemoryDisplay();
                
            } catch (error) {
                console.error('Error fetching repositories:', error);
                playSound('error');
                showError("Connection Error", error.message);
            }
        }
        
        // Render repositories
        function renderRepositories(repos) {
            const reposContainer = document.getElementById('repos-container');
            
            // Update repository count
            document.getElementById('repo-count').textContent = `${repos.length} object(s)`;
            
            // Keep the header if in details view
            const header = reposContainer.querySelector('.win95-details-header');
            
            // Clear container but preserve header if exists
            reposContainer.innerHTML = '';
            
            // Re-add header if it existed
            if (header && currentView === 'details') {
                reposContainer.appendChild(header);
            }
            
            // Add each repository as an icon
            repos.forEach((repo, index) => {
                const repoItem = document.createElement('div');
                repoItem.className = 'win95-repo-item';
                
                // Determine icon based on language
                let iconClass = 'fas fa-file-code';
                if (repo.language) {
                    if (repo.language === 'JavaScript') iconClass = 'fab fa-js-square';
                    else if (repo.language === 'HTML') iconClass = 'fab fa-html5';
                    else if (repo.language === 'CSS') iconClass = 'fab fa-css3-alt';
                    else if (repo.language === 'Python') iconClass = 'fab fa-python';
                    else if (repo.language === 'Java') iconClass = 'fab fa-java';
                    else if (repo.language === 'PHP') iconClass = 'fab fa-php';
                    else if (repo.language === 'Ruby') iconClass = 'fas fa-gem';
                    else if (repo.language === 'C#') iconClass = 'fab fa-microsoft';
                    else if (repo.language === 'TypeScript') iconClass = 'fab fa-js-square';
                }
                
                // Format date
                const updatedDate = new Date(repo.updated_at).toLocaleDateString();
                
                // Different HTML structure based on view mode
                if (currentView === 'details') {
                    repoItem.innerHTML = `
                        <div class="win95-repo-icon">
                            <i class="${iconClass}"></i>
                        </div>
                        <div class="win95-repo-name">${repo.name}</div>
                        <div class="win95-repo-details">
                            <div class="win95-repo-detail">${repo.language || 'Unknown'}</div>
                            <div class="win95-repo-detail">${repo.size} KB</div>
                            <div class="win95-repo-detail">${updatedDate}</div>
                            <div class="win95-repo-detail">${repo.stargazers_count}</div>
                        </div>
                    `;
                } else {
                    repoItem.innerHTML = `
                        <div class="win95-repo-icon">
                            <i class="${iconClass}"></i>
                        </div>
                        <div class="win95-repo-name">${repo.name}</div>
                    `;
                }
                
                // Event listeners
                repoItem.addEventListener('click', (e) => {
                    playSound('click');
                    
                    // Deselect all other items
                    document.querySelectorAll('.win95-repo-item').forEach(item => {
                        item.classList.remove('selected');
                    });
                    
                    // Select this item
                    repoItem.classList.add('selected');
                    selectedRepo = repo;
                    selectedRepoIndex = index;
                });
                
                repoItem.addEventListener('dblclick', () => {
                    playSound('click');
                    showRepoProperties(repo);
                });
                
                repoItem.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    
                    // Select the item
                    document.querySelectorAll('.win95-repo-item').forEach(item => {
                        item.classList.remove('selected');
                    });
                    
                    repoItem.classList.add('selected');
                    selectedRepo = repo;
                    selectedRepoIndex = index;
                    
                    // Show context menu
                    const contextMenu = document.getElementById('repo-context-menu');
                    contextMenu.style.display = 'block';
                    contextMenu.style.left = e.pageX + 'px';
                    contextMenu.style.top = e.pageY + 'px';
                    
                    // Add event listener to hide menu on click elsewhere
                    setTimeout(() => {
                        document.addEventListener('click', hideContextMenus, { once: true });
                    }, 0);
                });
                
                reposContainer.appendChild(repoItem);
            });
        }
        
        // Show error message
        function showError(title, message) {
            const reposContainer = document.getElementById('repos-container');
            
            reposContainer.innerHTML = `
                <div style="padding: 20px; text-align: center;">
                    <div style="font-size: 48px; color: red; margin-bottom: 20px;">×</div>
                    <div style="font-weight: bold; margin-bottom: 10px;">${title}</div>
                    <div style="margin-bottom: 20px;">${message}</div>
                    <button class="win95-button" onclick="fetchRepositories()">Retry</button>
                </div>
            `;
        }
        
        // Shutdown function
        function shutdown() {
            playSound('click');
            
            document.body.innerHTML = `
                <div class="win95-startup" style="opacity: 1; visibility: visible; background-color: black;">
                    <div class="win95-startup-message" style="margin-top: 0; font-size: 18px;">It's now safe to turn off your computer.</div>
                </div>
            `;
        }
    </script>
