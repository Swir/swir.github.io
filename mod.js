(function(){try{console.log("===== CZATERIA MEGA MOD 6.7 ULTIMATE =====");const d="2020-01-01 00:00:00";CHNS.userDataRegistered=d;if(CHNS.avatarLastChangeDate)CHNS.avatarLastChangeDate=d;if(CHNS.lastAvatarChange)CHNS.lastAvatarChange=d;if(CHNS.userSettings&&CHNS.userSettings.avatarLastChangeDate)CHNS.userSettings.avatarLastChangeDate=d;if(CHNS.userSettings&&CHNS.userSettings.canChangeAvatar)CHNS.userSettings.canChangeAvatar=function(){return true};console.log("✅ Data rejestracji zmieniona na:",d);document.querySelectorAll('#extreme-donos-btn,#donos-btn').forEach(el=>el.remove());let activatedFeatures={antiSpam:false,privateMessages:false,avatarLimits:false,wordFilters:false,emoticons:false,adminMode:false};function unlockPrivateMessages(){try{if(CHNS.privMessage){CHNS.privMessage.canSend=function(){return true};CHNS.privMessage.isBlocked=function(){return false};CHNS.privMessage.isBlockedBy=function(){return false};}if(CHNS.roomAndPrivs){CHNS.roomAndPrivs.canSendPriv=function(){return true};CHNS.roomAndPrivs.isBlocked=function(){return false};}if(CHNS.Connection&&CHNS.Connection.prototype){if(CHNS.Connection.prototype.canPrivMessage){CHNS.Connection.prototype.canPrivMessage=function(){return true};}if(CHNS.Connection.prototype.sendPrivMessage){const origSendPriv=CHNS.Connection.prototype.sendPrivMessage;CHNS.Connection.prototype.sendPrivMessage=function(nick,msg,msgId){return origSendPriv.apply(this,arguments);}}}if(CHNS.listUsersOperations){if(CHNS.listUsersOperations.isBlocked)CHNS.listUsersOperations.isBlocked=function(){return false};if(CHNS.listUsersOperations.isBlockedBy)CHNS.listUsersOperations.isBlockedBy=function(){return false};}if(CHNS.privMessageManager){if(CHNS.privMessageManager.canSendToUser)CHNS.privMessageManager.canSendToUser=function(){return true};if(CHNS.privMessageManager.isUserBlocked)CHNS.privMessageManager.isUserBlocked=function(){return false};}if(CHNS.User&&CHNS.User.prototype){if(CHNS.User.prototype.canReceivePriv)CHNS.User.prototype.canReceivePriv=function(){return true};if(CHNS.User.prototype.hasPrivMessagesDisabled)CHNS.User.prototype.hasPrivMessagesDisabled=function(){return false};}if(CHNS.Channel&&CHNS.Channel.prototype){if(CHNS.Channel.prototype.canSendPrivateMessage)CHNS.Channel.prototype.canSendPrivateMessage=function(){return true};}if(CHNS.serverMessages){const origProcessMsg=CHNS.serverMessages.processMessage;CHNS.serverMessages.processMessage=function(msg){if(msg&&(msg.code===22||msg.code===23||msg.code===24)){return;}return origProcessMsg.apply(this,arguments);};}activatedFeatures.privateMessages=true;console.log("✅ Odblokowano wiadomości prywatne - wersja rozszerzona");}catch(e){console.error("Błąd odblokowywania wiadomości prywatnych:",e);}}function unlockAvatarLimits(){try{if(CHNS.userSettings){CHNS.userSettings.canChangeAvatar=function(){return true};CHNS.userSettings.avatarChangeTimeLeft=function(){return 0};CHNS.userSettings.avatarLastChangeDate=d;}activatedFeatures.avatarLimits=true;console.log("✅ Odblokowano zmianę awatara");}catch(e){console.error("Błąd odblokowywania limitów awatara:",e);}}function bypassWordFilters(){try{if(CHNS.messages&&CHNS.messages.filterWords){CHNS.messages.filterWords=function(msg){return msg};}if(CHNS.messages&&CHNS.messages.blockedWords){CHNS.messages.blockedWords=[];}activatedFeatures.wordFilters=true;console.log("✅ Wyłączono filtry słów");}catch(e){console.error("Błąd obchodzenia filtrów słów:",e);}}function unlockAllEmoticons(){try{if(CHNS.emoticons){CHNS.emoticons.isAvailable=function(){return true};CHNS.emoticons.canUse=function(){return true};}if(CHNS.giflandia){CHNS.giflandia.canUse=function(){return true};CHNS.giflandia.isAvailable=function(){return true};}activatedFeatures.emoticons=true;console.log("✅ Odblokowano wszystkie emotikony i gify");}catch(e){console.error("Błąd odblokowywania emotek:",e);}}function adminFix(){try{if(CHNS.connManager&&CHNS.connManager.meUser){CHNS.connManager.meUser.admin=true;CHNS.connManager.meUser.role="admin";CHNS.connManager.meUser.honour=true;CHNS.connManager.meUser.canAccessDelations=true;CHNS.connManager.meUser.isSendingSpy=true;}Object.keys(CHNS.connManager.connections).forEach(key=>{try{if(CHNS.connManager.connections[key]&&CHNS.connManager.connections[key].meUser){CHNS.connManager.connections[key].meUser.admin=true;CHNS.connManager.connections[key].meUser.role="admin";CHNS.connManager.connections[key].meUser.honour=true;CHNS.connManager.connections[key].meUser.canAccessDelations=true;CHNS.connManager.connections[key].meUser.isSendingSpy=true;}}catch(e){}});if(CHNS.userRole){CHNS.userRole.isAdmin=function(){return true};CHNS.userRole.isModerator=function(){return true};CHNS.userRole.isBeforeModerator=function(){return true};CHNS.userRole.isModeratorAssistant=function(){return true};CHNS.userRole.isHonour=function(){return true};CHNS.userRole.currentRole="admin";CHNS.userRole.currentPerm=1;}if(CHNS.meUserData){CHNS.meUserData.admin=true;CHNS.meUserData.honour=true;CHNS.meUserData.canAccessDelations=true;}if(window.user&&window.user.data){window.user.data.role="admin";window.user.data.honour=true;}if(CHNS.connManager&&CHNS.connManager.getMeUser){const originalGetMeUser=CHNS.connManager.getMeUser;CHNS.connManager.getMeUser=function(){let user=originalGetMeUser.call(CHNS.connManager);if(user){user.isAdmin=function(){return true};user.isHonour=function(){return true};user.isModerator=function(){return true};user.isModeratorAssistant=function(){return true};user.isBeforeModerator=function(){return true};user.isSuperAdmin=function(){return true};user.getPerm=function(){return 1};}return user};}if(CHNS.Connection&&CHNS.Connection.prototype){const origServerExc=CHNS.Connection.prototype.serverExceptions;CHNS.Connection.prototype.serverExceptions=function(data){if(data&&data.subcode===5)return;return origServerExc.apply(this,arguments);}}if(CHNS.Room&&CHNS.Room.prototype){CHNS.Room.prototype.isOwner=function(){return true};CHNS.Room.prototype.canManage=function(){return true};}if(CHNS.Room){if(CHNS.Room.canManage)CHNS.Room.canManage=function(){return true};if(CHNS.Room.isOwner)CHNS.Room.isOwner=function(){return true};}activatedFeatures.adminMode=true;}catch(e){console.error("adminFix error:",e);}}function disableAntiSpam(){try{if(CHNS.messages){if(typeof CHNS.messages.isFloodWaiting!=="undefined"){CHNS.messages.isFloodWaiting=function(){return false};}if(typeof CHNS.messages.floodWait!=="undefined"){CHNS.messages.floodWait=0}if(typeof CHNS.messages.floodWaitTime!=="undefined"){CHNS.messages.floodWaitTime=0}if(typeof CHNS.messages.typingDelay!=="undefined"){CHNS.messages.typingDelay=0}if(typeof CHNS.messages.sendDelay!=="undefined"){CHNS.messages.sendDelay=0}if(typeof CHNS.messages.isSpam!=="undefined"){CHNS.messages.isSpam=function(){return false}}if(typeof CHNS.messages.checkSpam!=="undefined"){CHNS.messages.checkSpam=function(){return false}}if(typeof CHNS.messages.updateSpamFilter!=="undefined"){CHNS.messages.updateSpamFilter=function(){return false}}if(typeof CHNS.messages.applyFilter!=="undefined"){CHNS.messages.applyFilter=function(msg){return msg}}if(typeof CHNS.messages.lastMessageTime!=="undefined"){CHNS.messages.lastMessageTime=0}}if(CHNS.spam){if(typeof CHNS.spam.isSpam!=="undefined"){CHNS.spam.isSpam=function(){return false}}if(typeof CHNS.spam.test!=="undefined"){CHNS.spam.test=function(){return false}}if(typeof CHNS.spam.check!=="undefined"){CHNS.spam.check=function(){return false}}if(typeof CHNS.spam.delay!=="undefined"){CHNS.spam.delay=0}}if(typeof CHNS.rateLimits!=="undefined"){CHNS.rateLimits={};}if(CHNS.Channel&&CHNS.Channel.prototype){const origSendMessage=CHNS.Channel.prototype.sendMessage;CHNS.Channel.prototype.sendMessage=function(input){const now=new Date().getTime();if(this.lastMessageTime){this.lastMessageTime=now-10000;}if(this.typingTime){this.typingTime=now-10000;}return origSendMessage.apply(this,arguments);}}activatedFeatures.antiSpam=true;console.log("✅ System antyspamowy wyłączony");}catch(e){console.error("Błąd podczas wyłączania antyspamu:",e);}}function fixDelationAccess(){try{CHNS.delationRoom={id:"delations",test:function(){return true},access:function(){return true},allowAccess:true};}catch(e){console.error("Error fixing delationRoom:",e)}try{if(CHNS.channelManager){CHNS.channelManager.isAdmin=function(){return true};CHNS.channelManager.allowDelation=true;}if(CHNS.meUserData){CHNS.meUserData.admin=true;CHNS.meUserData.honour=true;}if(window.user&&window.user.data){window.user.data.role="admin";window.user.data.honour=true;}}catch(e){console.error("Error modifying other admin objects:",e)}}function unblockAll(){try{if(typeof CHNS!=="undefined"){if(CHNS.detectInspector){CHNS.detectInspector=function(){return false}}if(CHNS.blockInspector){CHNS.blockInspector.disable=function(){return true};CHNS.blockInspector.enabled=false;}if(window.BLOCK_INSPECTOR_ENABLED)window.BLOCK_INSPECTOR_ENABLED=false;if(CHNS.giflandia&&typeof CHNS.giflandia.limitGifsInMessage!=="undefined"){CHNS.giflandia.limitGifsInMessage=9999;CHNS.giflandia.getGifsInMessage=function(){return 0;};}if(typeof CHNS.MAX_PRIVS!=="undefined"){CHNS.MAX_PRIVS=9999}if(CHNS.images&&typeof CHNS.images.uploadLimit!=="undefined"){CHNS.images.uploadLimit=9999}if(typeof CHNS.chatRestrictions!=="undefined"){CHNS.chatRestrictions={}}}}catch(e){console.error("Error in basic unblock:",e)}}unblockAll();function getActiveFeaturesList(){let features=[];if(activatedFeatures.antiSpam)features.push("AntySpam");if(activatedFeatures.privateMessages)features.push("Wiadomości prywatne");if(activatedFeatures.avatarLimits)features.push("Limity awatarów");if(activatedFeatures.wordFilters)features.push("Filtry słów");if(activatedFeatures.emoticons)features.push("Wszystkie emotikony");if(activatedFeatures.adminMode)features.push("Tryb administratora");return features.length>0?features.join(", "):"Brak"}function getCurrentInputField(){var a=document.querySelectorAll("input.text-input");for(var i=0;i<a.length;i++){var st=window.getComputedStyle(a[i]);if(st.display!=="none"&&st.visibility!=="hidden"&&a[i].offsetHeight>0)return a[i]}return null}window._gifHandlerInstalled=false;function enableGifClick(){if(window._gifHandlerInstalled){document.querySelectorAll("img.img-gif, img.img-icon").forEach(img=>{img.classList.remove("media-click-enabled");var newImg=img.cloneNode(true);img.parentNode.replaceChild(newImg,img)});}try{["img.img-gif","img.img-icon"].forEach(sel=>{document.querySelectorAll(sel).forEach(img=>{if(!img.classList.contains("media-click-enabled")){img.classList.add("media-click-enabled");img.style.cursor="pointer";img.addEventListener("click",function(e){e.preventDefault();e.stopPropagation();let code=img.getAttribute("data-tooltip");let inp=getCurrentInputField();if(code&&inp){inp.value+=" "+code;inp.focus();}return false;},true);}})});window._gifHandlerInstalled=true;}catch(e){console.log("błąd enableGifClick:",e)}}enableGifClick();function unblockCaptcha(){try{if(CHNS.captcha){CHNS.captcha.check=function(){return Promise.resolve(true)};CHNS.captcha.reset=function(){};CHNS.captcha.show=function(){return Promise.resolve(true)};CHNS.captcha.isRequired=function(){return false};CHNS.captcha.autoSolve=true;}}catch(e){console.error("Błąd blokowania CAPTCHA:",e)}}unblockCaptcha();function forcePrivateMessageEnabling(){try{console.log("%F0%9F%94%93 Wymuszanie możliwości pisania prywatnych wiadomości...");unlockPrivateMessages();if(CHNS.userSettings){CHNS.userSettings.disablePrivmsg=false;CHNS.userSettings.canReceivePrivs=function(){return true};}if(CHNS.privBlock){CHNS.privBlock.disable();}const allUserFunctions=['canReceivePriv','isBlocked','hasPrivMessagesDisabled','isIgnored'];if(CHNS.User&&CHNS.User.prototype){allUserFunctions.forEach(fn=>{if(CHNS.User.prototype[fn]){CHNS.User.prototype[fn]=function(){return fn==='canReceivePriv'?true:false;};}});}if(CHNS.userSettings&&CHNS.userSettings.allowPrivmsgs!==undefined){CHNS.userSettings.allowPrivmsgs=true;}function forceOpenPrivTab(nick){if(!nick)return;try{const conn=CHNS.connManager.connections[CHNS.activemaintabname];if(!conn)return;const user=conn.channelMain.roomAndPrivs.getUserByNick(nick);if(!user)return;CHNS.viewManager.openPrivTab(user,"",conn,"",true);}catch(e){console.log("Error opening priv tab:",e);}}if(CHNS.viewManager&&CHNS.viewManager.openPrivTab){const origOpenPriv=CHNS.viewManager.openPrivTab;CHNS.viewManager.openPrivTab=function(user){forceOpenPrivTab(user.nick);return origOpenPriv.apply(this,arguments);};}if(CHNS.addNewPrivWindow){const origAddNew=CHNS.addNewPrivWindow;CHNS.addNewPrivWindow=function(u,conn){if(u){u.canReceivePriv=function(){return true};u.hasPrivMessagesDisabled=function(){return false};}return origAddNew.apply(this,arguments);};}console.log("✅ Wymuszanie wiadomości prywatnych zakończone!");}catch(e){console.error("Błąd podczas wymuszania wiadomości prywatnych:",e);}}function fixBlockedFunctions(){try{const origServerExceptions=CHNS.Connection.prototype.serverExceptions;CHNS.Connection.prototype.serverExceptions=function(data){if(data&&data.subcode===5)return;if(data&&data.code===0&&data.detailsCode===403)return;if(data&&data.code===0&&data.detailsCode===429)return;if(data&&data.code===22)return;if(data&&data.code===23)return;if(data&&data.code===24)return;return origServerExceptions.apply(this,arguments)};const origCheck=CHNS.cookie.checkBanOnRoom;CHNS.cookie.checkBanOnRoom=function(){return false};CHNS.cookie.setBanOnRoom=function(){};if(CHNS.Channel&&CHNS.Channel.prototype){CHNS.Channel.prototype.incrementVulgarCounter=function(){};CHNS.Channel.prototype.vulgarCounter=0;CHNS.Channel.prototype.setUserGetImageConfirmation=function(){this.userGetImageConfirmation=true};CHNS.Channel.prototype.waitingForUserImageConfirmation=function(){return false};CHNS.Channel.prototype.setInputUploadButtonDisabled=function(){this.inputUploadButtonDisabled=false};CHNS.Channel.prototype.isInputUploadButtonDisabled=function(){return false};CHNS.Channel.prototype.setAllowImageUpload=function(){this.allowImageUpload=true};CHNS.Channel.prototype.getAllowImageUpload=function(){return true};}}catch(e){console.error("Błąd podczas odblokowywania funkcji:",e)}}fixBlockedFunctions();function fixWhereIsUser(){try{const originalWhereIsUser=CHNS.Connection.prototype.whereIsUser;CHNS.Connection.prototype.whereIsUser=function(nick){const result=originalWhereIsUser.apply(this,arguments);const self=this;setTimeout(function(){const user=self.channelMain.roomAndPrivs.getUserByNick(nick);if(!user){self.channelMain.addRoomInfoMessage(new CHNS.SystemMessage({msg:%60Użytkownik <b>${nick}</b> nie został znaleziony w systemie.%60}),true);return;}const msg={code:38,nick:nick};const origOnMessage=self.onmessage;self.onmessage=function(evt){try{const data=JSON.parse(evt.data);if(data&&data.code===39){let message="";if(data.rooms&&data.rooms.length>0){message=%60Użytkownik <b>${nick}</b> jest obecnie w pokojach: %60;message+=data.rooms.map(room=>%60<b>${room.name}</b>%60).join(", ");}else{message=%60Użytkownik <b>${nick}</b> nie jest obecnie zalogowany w żadnym pokoju.%60;}self.channelMain.addRoomInfoMessage(new CHNS.SystemMessage({msg:message}),true);self.onmessage=origOnMessage;return;}}catch(e){}return origOnMessage.apply(self,arguments);};self.send(JSON.stringify(msg));setTimeout(function(){self.onmessage=origOnMessage;},5000);},100);return result;};}catch(e){console.error("Błąd naprawy whereIsUser:",e);}}fixWhereIsUser();function clearBrowserData(){let clearedItems=[];try{const keysToSave=["konf_nickBg","konf_nickTx","konf_nickAnim","konf_nickName","konf_nickOn","konf_nickSoundOn","konf_nickSoundUrl","konf_chatBg","lastUsedNick","czateria_znajomi","czateria_ignorowani"];const savedValues={};for(let key of keysToSave){savedValues[key]=localStorage.getItem(key);}const allKeys=[];for(let i=0;i<localStorage.length;i++){allKeys.push(localStorage.key(i));}for(let key of allKeys){if(key&&!keysToSave.includes(key)){localStorage.removeItem(key);}}for(let key in savedValues){if(savedValues[key]!==null){localStorage.setItem(key,savedValues[key]);}}clearedItems.push('localStorage');}catch(e){console.error("Error clearing localStorage:",e);}try{for(let i=0;i<sessionStorage.length;i++){const key=sessionStorage.key(i);if(key&&!key.startsWith('swir_config_')){sessionStorage.removeItem(key);}}clearedItems.push('sessionStorage');}catch(e){console.error("Error clearing sessionStorage:",e);}try{const cookies=document.cookie.split(';');for(let i=0;i<cookies.length;i++){const cookie=cookies[i];const eqPos=cookie.indexOf('=');const name=eqPos>-1?cookie.substr(0,eqPos).trim():cookie.trim();if(name&&!name.startsWith('konf_')&&!name.startsWith('config_')){document.cookie=name+'=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/';}}clearedItems.push('cookies');}catch(e){console.error("Error clearing cookies:",e);}try{if(CHNS){if(CHNS.cache)CHNS.cache={};if(CHNS.messages&&CHNS.messages.cache)CHNS.messages.cache=[];if(CHNS.history)CHNS.history=[];if(CHNS.chatCache)CHNS.chatCache={};if(CHNS.listRoomsOperations&&CHNS.listRoomsOperations.roomsCache){CHNS.listRoomsOperations.roomsCache={};}}clearedItems.push('cache pamięci');}catch(e){console.error("Error clearing CHNS cache:",e);}return clearedItems;}function addMultiCommands(){try{const originalSendMessage=CHNS.Channel.prototype.sendMessage;CHNS.Channel.prototype.sendMessage=function(e){const msg=e.value.trim();if(msg.startsWith("/join ")){const roomName=msg.substring(6).trim();if(roomName){try{const roomData=CHNS.listRoomsOperations.getRoomRelatedWithName(roomName);if(roomData){const roomId=roomData.getId();CHNS.waitingForConnection.logIn(roomName,CHNS.ChannelType.ROOM,roomId);this.addRoomInfoMessage(new CHNS.SystemMessage({msg:%60~Próba dołączenia do pokoju: <b>${roomName}</b>%60}),true);return true}else{this.addRoomErrorMessage(%60~Pokój o nazwie "${roomName}" nie istnieje lub jest niedostępny%60);return true}}catch(error){this.addRoomErrorMessage(%60~Błąd podczas dołączania do pokoju: ${error.message||"nieznany błąd"}%60);return true}}else{this.addRoomErrorMessage("~Podaj nazwę pokoju po komendzie /join");return true}}else if(msg.startsWith("/find ")||msg.startsWith("/szukaj ")){const nick=msg.startsWith("/find ")?msg.substring(6).trim():msg.substring(8).trim();if(nick){const connection=CHNS.connManager.connections[CHNS.activemaintabname];if(connection){connection.whereIsUser(nick);return true;}else{this.addRoomErrorMessage("~Brak aktywnego połączenia");return true;}}else{this.addRoomErrorMessage("~Podaj nick użytkownika do wyszukania");return true;}}else if(msg==="/help"||msg==="/pomoc"){this.addRoomInfoMessage(new CHNS.SystemMessage({msg:"~<b>MEGA MOD 6.7 ULTIMATE</b><br>Dostępne komendy:<br>/join &lt;nazwa_pokoju&gt; - dołącz do pokoju<br>/clear - wyczyść historię czatu<br>/find &lt;nick&gt; - znajdź użytkownika<br>/szukaj &lt;nick&gt; - znajdź użytkownika<br>/nospam - wyłącz ograniczenia antyspamowe<br>/unlock - odblokuj wszystkie funkcje<br>/forcepriv - wymuś możliwość pisania prywatnych wiadomości<br>/admin - nadaj sobie uprawnienia administratora<br>/status - pokaż aktywne funkcje"}),true);return true}else if(msg==="/clear"||msg==="/wyczysc"){try{const messagesList=this.view.getMessagesMainList();if(messagesList){while(messagesList.firstChild){messagesList.removeChild(messagesList.firstChild);}this.addRoomInfoMessage(new CHNS.SystemMessage({msg:"~Historia czatu została wyczyszczona"}),true);}return true;}catch(error){this.addRoomErrorMessage(%60~Błąd podczas czyszczenia historii: ${error.message||"nieznany błąd"}%60);return true}}else if(msg==="/nospam"){try{disableAntiSpam();this.addRoomInfoMessage(new CHNS.SystemMessage({msg:"~Antyspam został wyłączony! Teraz możesz pisać bez ograniczeń czasowych."}),true);return true;}catch(error){this.addRoomErrorMessage(%60~Błąd podczas wyłączania antyspamu: ${error.message||"nieznany błąd"}%60);return true}}else if(msg==="/forcepriv"){try{forcePrivateMessageEnabling();this.addRoomInfoMessage(new CHNS.SystemMessage({msg:"~Wymuszono możliwość pisania prywatnych wiadomości! Spróbuj teraz napisać do użytkownika."}),true);return true;}catch(error){this.addRoomErrorMessage(%60~Błąd podczas wymuszania privów: ${error.message||"nieznany błąd"}%60);return true}}else if(msg==="/unlock"){try{unlockPrivateMessages();unlockAvatarLimits();bypassWordFilters();unlockAllEmoticons();forcePrivateMessageEnabling();this.addRoomInfoMessage(new CHNS.SystemMessage({msg:"~Wszystkie funkcje odblokowane! Masz teraz pełne możliwości na czacie."}),true);return true;}catch(error){this.addRoomErrorMessage(%60~Błąd podczas odblokowywania wszystkich funkcji: ${error.message||"nieznany błąd"}%60);return true}}else if(msg==="/admin"){try{adminFix();fixDelationAccess();this.addRoomInfoMessage(new CHNS.SystemMessage({msg:"~Nadano uprawnienia administratora! Masz teraz pełną kontrolę nad pokojem."}),true);return true;}catch(error){this.addRoomErrorMessage(%60~Błąd podczas nadawania uprawnień administratora: ${error.message||"nieznany błąd"}%60);return true}}else if(msg==="/status"){try{const aktywne=getActiveFeaturesList();this.addRoomInfoMessage(new CHNS.SystemMessage({msg:%60~<b>Status funkcji MOD:</b><br>${aktywne||"Brak aktywnych funkcji. Użyj odpowiednich komend, by je włączyć."}%60}),true);return true;}catch(error){this.addRoomErrorMessage(%60~Błąd podczas pobierania statusu: ${error.message||"nieznany błąd"}%60);return true}}return originalSendMessage.apply(this,arguments)};console.log("Komendy zostały zainstalowane")}catch(e){console.error("Błąd podczas dodawania komend:",e)}}addMultiCommands();function safeGetItem(k){try{return localStorage.getItem(k)||""}catch(e){return""}}function safeSetItem(k,v){try{localStorage.setItem(k,v)}catch(e){}}let chatBg=safeGetItem("konf_chatBg")||"#222",nickBg=safeGetItem("konf_nickBg")||"#ff3",nickTx=safeGetItem("konf_nickTx")||"#000",nickAnim=safeGetItem("konf_nickAnim")||"#0f0",nickName=safeGetItem("konf_nickName")||"",nickOn=(safeGetItem("konf_nickOn")==="true"),nickSoundOn=(safeGetItem("konf_nickSoundOn")==="true"),nickSoundUrl=safeGetItem("konf_nickSoundUrl")||"https://raw.githubusercontent.com/Swir/swir.github.io/refs/heads/main/ding.mp3";if(!nickName&&CHNS&&CHNS.connManager&&CHNS.connManager.meUser&&CHNS.connManager.meUser.nick){nickName=CHNS.connManager.meUser.nick;safeSetItem("konf_nickName",nickName);}if(safeGetItem("konf_nickOn")===""){nickOn=true;safeSetItem("konf_nickOn","true");}if(safeGetItem("konf_nickSoundOn")===""){nickSoundOn=true;safeSetItem("konf_nickSoundOn","true");}function getVisibleChatContainer(){var c=document.querySelectorAll(".chat-container");for(var i=0;i<c.length;i++){var s=window.getComputedStyle(c[i]);if(s.display!=="none"&&s.visibility!=="hidden"&&c[i].offsetHeight>0)return c[i]}return null}function setChatBg(c){chatBg=c;safeSetItem("konf_chatBg",chatBg);document.body.style.backgroundColor=chatBg;document.body.style.color="#a8ff60";let cont=getVisibleChatContainer();cont&&(cont.style.border="2px solid #0f0");let fbb=document.querySelector(".floatbox-box-background");fbb&&(fbb.style.backgroundColor=chatBg)}function restoreChatBg(){setChatBg(chatBg)}function updateNeonKeyframes(col){let st=document.getElementById("myNeonKeyframes");st&&st.remove();var css="@keyframes neonPulseX{0%{box-shadow:0 0 10px "+col+",0 0 20px "+col+"}50%{box-shadow:0 0 25px "+col+",0 0 40px "+col+"}100%{box-shadow:0 0 10px "+col+",0 0 20px "+col+"}}",sty=document.createElement("style");sty.id="myNeonKeyframes",sty.textContent=css,document.head.appendChild(sty)}function saveHighlightState(){safeSetItem("konf_nickBg",nickBg);safeSetItem("konf_nickTx",nickTx);safeSetItem("konf_nickAnim",nickAnim);safeSetItem("konf_nickName",nickName);safeSetItem("konf_nickOn",nickOn.toString());safeSetItem("konf_nickSoundOn",nickSoundOn.toString());safeSetItem("konf_nickSoundUrl",nickSoundUrl);}function findNickInMessage(messageText,nick){if(!nick||!messageText||nick.trim()==='')return false;const lowerMessage=messageText.toLowerCase();const lowerNick=nick.toLowerCase();const position=lowerMessage.indexOf(lowerNick);if(position===-1)return false;const beforeChar=position===0?' ':lowerMessage[position-1];const afterChar=position+lowerNick.length>=lowerMessage.length?' ':lowerMessage[position+lowerNick.length];const validBeforeChars=' ,.!?:;()[]{}<>-_=+*/\\|"\'';const validAfterChars=' ,.!?:;()[]{}<>-_=+*/\\|"\',';return(validBeforeChars.indexOf(beforeChar)!==-1&&validAfterChars.indexOf(afterChar)!==-1);}function playHighlightSound(){if(!nickSoundOn)return;try{if(!nickSoundUrl||nickSoundUrl.trim()===''){nickSoundUrl='https://raw.githubusercontent.com/Swir/swir.github.io/refs/heads/main/ding.mp3';safeSetItem("konf_nickSoundUrl",nickSoundUrl);}const audio=new Audio(nickSoundUrl);audio.volume=0.6;audio.play().catch(e=>{console.error("Błąd odtwarzania dźwięku:",e);const backupSoundUrl='https://raw.githubusercontent.com/Swir/swir.github.io/refs/heads/main/ding.mp3';const backupAudio=new Audio(backupSoundUrl);backupAudio.volume=0.6;backupAudio.play().catch(err=>{console.error("Również nie udało się odtworzyć zapasowego dźwięku:",err);})});}catch(e){console.error("Błąd dźwięku:",e);}}let highlightedMessages=new Set();function applyHighlightStyle(messageElement){if(!messageElement)return;if(highlightedMessages.has(messageElement.innerText))return;highlightedMessages.add(messageElement.innerText);messageElement.setAttribute("data-swir-highlighted","true");messageElement.style.display="block";messageElement.style.padding="4px 8px";messageElement.style.margin="4px 0";messageElement.style.background=nickBg;messageElement.style.color=nickTx;messageElement.style.boxShadow="0 0 10px "+nickAnim;messageElement.style.animation="neonPulseX 1.5s ease-in-out infinite alternate";messageElement.style.borderRadius="5px";messageElement.style.border="1px solid "+nickAnim;updateNeonKeyframes(nickAnim);playHighlightSound();}function highlightMyNick(){if(!nickOn||!nickName||nickName.trim()==='')return;try{const messages=document.querySelectorAll(".m-msg-item-user-message");messages.forEach(msg=>{const messageText=msg.textContent||"";if(findNickInMessage(messageText,nickName)){applyHighlightStyle(msg);}});saveHighlightState();}catch(e){console.log("Błąd wyróżniania nicka:",e);}}function setupMessageObserver(){const observer=new MutationObserver(mutations=>{mutations.forEach(mutation=>{if(mutation.type==='childList'&&mutation.addedNodes.length){mutation.addedNodes.forEach(node=>{if(node.nodeType===1&&node.classList&&node.classList.contains("m-msg-item-user-message")){const messageText=node.textContent||"";if(nickOn&&nickName&&findNickInMessage(messageText,nickName)){applyHighlightStyle(node);}addTimestampToMessage(node);}});}});});const messagesContainer=document.querySelector(".m-messagesMainList");if(messagesContainer){observer.observe(messagesContainer,{childList:true,subtree:true});}return observer;}function addTimestampToMessage(msg){if(!msg||msg.querySelector(".timestamp"))return;msg.classList.add("timestamp-added");let sp=document.createElement("span");sp.className="timestamp";sp.style.color="#999";sp.style.fontSize="11px";sp.style.marginLeft="4px";sp.textContent=" ["+(new Date().toLocaleTimeString())+"]";msg.appendChild(sp);}function addTimestamps(){document.querySelectorAll(".m-msg-item-user-message:not(.timestamp-added)").forEach(msg=>{addTimestampToMessage(msg);});}function safeSetInputVal(inp,val){inp.value=val||""}function styleAllInputFields(){document.querySelectorAll("input.text-input").forEach(inp=>{inp.style.backgroundColor="#000";inp.style.color="#0f0";inp.style.border="1px solid #0f0";inp.style.fontFamily="monospace"})}function applyRoomFeatures(){let allContainers=document.querySelectorAll(".chat-container");allContainers.forEach(c=>{if(!c.querySelector(".general-file-input")){let f=document.createElement("input");f.type="file";f.className="general-file-input";f.accept="image/*";f.style.margin="10px 0";f.style.display="block";f.addEventListener("change",e=>alert("Wybrano plik: "+(e.target.files[0]?e.target.files[0].name:"(brak)")));c.appendChild(f)}c.style.border="2px solid #0f0";c.style.borderRadius="6px";c.style.padding="5px";c.style.boxShadow="0 0 10px rgba(0,255,0,0.3)";});let userList=document.querySelector(".m-roomAndPrivs-userList");if(userList){userList.style.border="2px solid #0f0";userList.style.borderRadius="6px";userList.style.padding="5px";userList.style.boxShadow="0 0 10px rgba(0,255,0,0.3)";}let gameBtn=document.querySelector(".m-game.js-play-game");gameBtn&&gameBtn.remove();enableGifClick();styleAllInputFields();highlightMyNick();addTimestamps()}function fixPaste(){document.addEventListener("paste",function(e){let activeElement=document.activeElement;if(activeElement&&activeElement.tagName==="INPUT"&&activeElement.classList.contains("text-input")){let clipboardData=e.clipboardData||window.clipboardData;let pastedText=clipboardData.getData("text");if(pastedText){activeElement.value+=pastedText;e.preventDefault();e.stopPropagation();return false}}},true)}fixPaste();function testSound(url){try{const soundUrl=url||nickSoundUrl||"https://raw.githubusercontent.com/Swir/swir.github.io/refs/heads/main/ding.mp3";const tempAudio=new Audio(soundUrl);tempAudio.volume=0.6;let playPromise=tempAudio.play();if(playPromise!==undefined){playPromise.then(_=>{console.log("Dźwięk testowy odtworzony pomyślnie");setTimeout(()=>{tempAudio.pause();tempAudio.currentTime=0;},2000);}).catch(e=>{console.error("Błąd testu dźwięku:",e);alert("Błąd testu dźwięku: "+e.message);});}}catch(e){console.error("Błąd testu dźwięku:",e);alert("Błąd testu dźwięku: "+e.message);}}function addConfigPanel(){if(document.getElementById("configPanel"))return document.getElementById("configPanel");let d=document.createElement("div");d.id="configPanel";d.style.position="fixed";d.style.top="50%";d.style.left="50%";d.style.transform="translate(-50%, -50%)";d.style.zIndex="999999";d.style.width="400px";d.style.backgroundColor="#222";d.style.padding="15px";d.style.border="2px solid #0f0";d.style.color="#fff";d.style.fontFamily="Arial, sans-serif";d.style.borderRadius="8px";d.style.boxShadow="0 0 20px rgba(0,255,0,0.3)";d.style.display="none";d.style.maxHeight="90vh";d.style.overflowY="auto";let html='<h2 style="margin:0 0 10px;color:#0f0;font-size:18px;padding-bottom:8px;border-bottom:1px solid #0f0;display:flex;justify-content:space-between"><span>Czateria MOD by Swir</span><button id="closeConfigBtn" style="background:none;border:none;color:#0f0;font-size:20px;cursor:pointer;height:20px;width:20px;padding:0;line-height:20px">&times;</button></h2><div style="display:flex;flex-direction:column;gap:15px"><div><h3 style="margin:0 0 5px;font-size:15px;color:#0f0">Tło czatu</h3><input type="color" id="colorPicker" value="'+chatBg+'" style="width:100%;height:30px;margin:5px 0"></div><div style="margin-top:5px;border-top:1px solid #444;padding-top:10px"><h3 style="margin:0 0 10px;font-size:15px;color:#0f0">Funkcje specjalne</h3><div style="display:grid;grid-template-columns:1fr 1fr;gap:10px"><button id="nospamBtn" style="padding:8px;background:#333;color:#fff;border:1px solid #0f0;border-radius:5px;cursor:pointer;font-size:13px;display:flex;align-items:center;justify-content:center"><span style="margin-right:5px">🚀</span>Wyłącz AntySpam</button><button id="unlockAllBtn" style="padding:8px;background:#333;color:#fff;border:1px solid #0f0;border-radius:5px;cursor:pointer;font-size:13px;display:flex;align-items:center;justify-content:center"><span style="margin-right:5px">%F0%9F%94%93</span>Odblokuj wszystko</button></div><div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px"><button id="adminBtn" style="padding:8px;background:#333;color:#fff;border:1px solid #0f0;border-radius:5px;cursor:pointer;font-size:13px;display:flex;align-items:center;justify-content:center"><span style="margin-right:5px">👑</span>Admin mode</button><button id="forcePrivBtn" style="padding:8px;background:#333;color:#fff;border:1px solid #0f0;border-radius:5px;cursor:pointer;font-size:13px;display:flex;align-items:center;justify-content:center"><span style="margin-right:5px">✉%EF%B8%8F</span>Wymuś privs</button></div><div style="display:grid;grid-template-columns:1fr;gap:10px;margin-top:10px"><button id="clearBtn" style="padding:8px;background:#333;color:#fff;border:1px solid #0f0;border-radius:5px;cursor:pointer;font-size:13px;display:flex;align-items:center;justify-content:center"><span style="margin-right:5px">🧹</span>Wyczyść pamięć</button></div><div style="margin-top:10px"><h4 style="margin:5px 0;font-size:14px;color:#0f0">Aktywne funkcje:</h4><p id="activeFeatures" style="margin:5px 0;color:#ccc;font-size:12px">Brak aktywnych funkcji</p></div></div><div style="margin-top:5px;border-top:1px solid #444;padding-top:15px"><h3 style="margin:0 0 10px;font-size:15px;color:#0f0">Ustawienia wyróżniania nicków</h3><div style="display:flex;align-items:center;margin-bottom:10px"><input type="checkbox" id="highlightCheckbox" '+(nickOn?"checked":"")+' style="margin-right:8px"><label for="highlightCheckbox">Włącz wyróżnianie wzmianek</label></div><div style="margin-bottom:15px"><label style="display:block;margin-bottom:5px">Nick do wyróżniania:</label><input type="text" id="nickInput" value="'+nickName+'" style="width:100%;padding:5px;box-sizing:border-box;background:#333;border:1px solid #555;color:#fff;border-radius:3px"></div><div style="display:grid;grid-template-columns:auto 1fr;gap:8px;align-items:center;margin-bottom:15px"><label>Tło wyróżnienia:</label><input type="color" id="bgColor" value="'+nickBg+'" style="width:100%"><label>Kolor tekstu:</label><input type="color" id="txColor" value="'+nickTx+'" style="width:100%"><label>Kolor animacji:</label><input type="color" id="animColor" value="'+nickAnim+'" style="width:100%"></div><div><h3 style="margin:0 0 10px;font-size:15px;color:#0f0">Dźwięk przy wzmiance</h3><div style="display:flex;align-items:center;margin-bottom:10px"><input type="checkbox" id="soundCheckbox" '+(nickSoundOn?"checked":"")+' style="margin-right:8px"><label for="soundCheckbox">Włącz powiadomienie dźwiękowe</label></div><div style="margin-bottom:10px"><label style="display:block;margin-bottom:5px">URL dźwięku:</label><input type="text" id="soundInput" value="'+nickSoundUrl+'" style="width:100%;padding:5px;box-sizing:border-box;background:#333;border:1px solid #555;color:#fff;border-radius:3px"></div><button id="testSound" style="padding:8px;background:#333;color:#0f0;border:1px solid #0f0;border-radius:5px;cursor:pointer;margin-top:5px;width:100%;display:flex;align-items:center;justify-content:center"><span style="margin-right:5px">🔊</span>Test dźwięku</button></div></div><div style="margin-top:5px;border-top:1px solid #444;padding-top:10px;text-align:center"><h3 style="margin:0 0 5px;font-size:15px;color:#0f0">Działające komendy</h3><p style="margin:0;color:#ccc;font-size:12px">/join &lt;pokój&gt; - dołącz do wskazanego pokoju<br>/clear - wyczyść historię czatu<br>/find &lt;nick&gt; - znajdź użytkownika<br>/szukaj &lt;nick&gt; - znajdź użytkownika<br>/nospam - wyłącz ograniczenia antyspamowe<br>/unlock - odblokuj wszystkie funkcje<br>/forcepriv - wymuś możliwość pisania prywatnych wiadomości<br>/admin - nadaj sobie uprawnienia administratora<br>/status - pokaż aktywne funkcje</p></div><div style="margin-top:10px;text-align:center;font-size:12px;color:#666">Czateria MOD v6.7 by Swir | 2025</div></div>';d.innerHTML=html;document.body.appendChild(d);function updateActiveFeaturesDisplay(){const featuresText=getActiveFeaturesList();document.getElementById("activeFeatures").textContent=featuresText||"Brak aktywnych funkcji";}document.getElementById("closeConfigBtn").onclick=function(){d.style.display="none";};document.getElementById("colorPicker").oninput=function(){setChatBg(this.value)};document.getElementById("nospamBtn").onclick=function(){disableAntiSpam();updateActiveFeaturesDisplay();alert("AntySpam został wyłączony! Możesz pisać bez ograniczeń czasowych.");};document.getElementById("unlockAllBtn").onclick=function(){unlockPrivateMessages();unlockAvatarLimits();bypassWordFilters();unlockAllEmoticons();forcePrivateMessageEnabling();updateActiveFeaturesDisplay();alert("Wszystkie funkcje odblokowane! Masz teraz pełne możliwości na czacie.");};document.getElementById("adminBtn").onclick=function(){adminFix();fixDelationAccess();updateActiveFeaturesDisplay();alert("Nadano uprawnienia administratora! Masz teraz pełną kontrolę nad pokojem.");};document.getElementById("forcePrivBtn").onclick=function(){forcePrivateMessageEnabling();updateActiveFeaturesDisplay();alert("Wymuszono możliwość pisania prywatnych wiadomości! Spróbuj teraz napisać do użytkownika.");};document.getElementById("clearBtn").onclick=function(){const cleared=clearBrowserData();alert(%60Wyczyszczono dane czatu z: ${cleared.join(", ")}.\n\nZachowano ustawienia wyróżnień, nicka i listę znajomych.\n\nZmiany będą w pełni widoczne po odświeżeniu strony.%60);setTimeout(()=>{if(confirm("Czy chcesz teraz odświeżyć stronę, aby zastosować zmiany?")){location.reload();}},500);};document.getElementById("highlightCheckbox").onchange=function(){nickOn=this.checked;highlightedMessages.clear();highlightMyNick();saveHighlightState();};document.getElementById("nickInput").oninput=function(){nickName=this.value;highlightedMessages.clear();highlightMyNick();saveHighlightState();};document.getElementById("bgColor").oninput=function(){nickBg=this.value;updateColors();};document.getElementById("txColor").oninput=function(){nickTx=this.value;updateColors();};document.getElementById("animColor").oninput=function(){nickAnim=this.value;updateColors();};function updateColors(){updateNeonKeyframes(nickAnim);saveHighlightState();highlightedMessages.clear();highlightMyNick();}document.getElementById("soundCheckbox").onchange=function(){nickSoundOn=this.checked;saveHighlightState();};document.getElementById("soundInput").oninput=function(){nickSoundUrl=this.value;saveHighlightState();};document.getElementById("testSound").onclick=function(){testSound(document.getElementById("soundInput").value);};updateActiveFeaturesDisplay();return d;}function toggleDisplay(e){e.style.display=e.style.display==="none"?"block":"none"}function enhanceInputField(){try{const inputs=document.querySelectorAll("input.text-input");inputs.forEach(input=>{if(input._enhancedKeydown)return;input._enhancedKeydown=true;input.addEventListener("keydown",function(e){if(e.key==="Tab"&&!e.ctrlKey&&!e.shiftKey&&!e.altKey){e.preventDefault();const currentValue=input.value;const inputs=document.querySelectorAll("input.text-input:not([style*='display: none'])");const currentIdx=Array.from(inputs).indexOf(input);if(currentIdx!==-1&&inputs.length>1){const nextIdx=(currentIdx+1)%inputs.length;inputs[nextIdx].focus();inputs[nextIdx].select()}}})})}catch(e){console.error("Błąd podczas dodawania obsługi Tab:",e)}}function initUI(){if(document.getElementById("btnConfig"))return;let btnCfg=document.createElement("button");btnCfg.id="btnConfig";btnCfg.innerHTML='<span style="margin-right:5px">⚡</span>MOD';btnCfg.style.position="fixed";btnCfg.style.top="10px";btnCfg.style.left="50%";btnCfg.style.transform="translateX(-50%)";btnCfg.style.zIndex="999999";btnCfg.style.padding="5px 15px";btnCfg.style.background="linear-gradient(to bottom, #333, #222)";btnCfg.style.color="#0f0";btnCfg.style.border="1px solid #0f0";btnCfg.style.cursor="pointer";btnCfg.style.borderRadius="20px";btnCfg.style.fontWeight="bold";btnCfg.style.boxShadow="0 0 10px rgba(0,255,0,0.3)";btnCfg.style.fontSize="14px";btnCfg.style.display="flex";btnCfg.style.alignItems="center";document.body.appendChild(btnCfg);window.configPanel=addConfigPanel();btnCfg.onclick=function(){toggleDisplay(configPanel)};restoreChatBg();highlightMyNick();enhanceInputField();}function setupFriendsAndIgnoreList(){try{function removeGameOrdinary(){try{document.querySelector(".m-messagesTextArea").style.backgroundImage="none"}catch(e){}try{document.querySelector(".js-play-game")?.remove()}catch(e){}}function handleFriendsPanel(e){let pan=document.getElementById("friends-panel");if(pan&&!e){pan.remove();return}if(pan&&e)pan.remove();let but=document.getElementById("friends");if(!but)return;let br=but.getBoundingClientRect(),dv=document.createElement("div");dv.id="friends-panel",dv.style.cssText=%60position:absolute;width:220px;height:350px;background:#2c2c2c;border:2px solid #0f0;border-radius:8px;padding:10px;overflow-y:auto;right:${window.innerWidth-br.right}px;top:${br.bottom+6}px;z-index:999999;box-shadow:0 0 15px rgba(0,255,0,0.3);%60;let h4=document.createElement("h4");h4.innerText="🧑%E2%80%8D🤝%E2%80%8D🧑 Znajomi",h4.style.textAlign="center";h4.style.color="#0f0";let xbtn=document.createElement("button");xbtn.innerText="❌",xbtn.style.float="right",xbtn.style.background="none",xbtn.style.border="none",xbtn.style.color="#0f0",xbtn.style.cursor="pointer",xbtn.onclick=()=>dv.remove(),h4.appendChild(xbtn),dv.appendChild(h4);let arr=JSON.parse(localStorage.czateria_znajomi||"[]");if(arr.length===0){let pp=document.createElement("p");pp.innerText="Nie masz jeszcze znajomych!",pp.style.textAlign="center",pp.style.color="white",dv.appendChild(pp)}else arr.forEach(u=>{let row=document.createElement("div");row.style.cssText="display:flex;justify-content:space-between;align-items:center;padding-bottom:8px;border-bottom:1px solid #444;margin-bottom:8px;";let sp=document.createElement("span");sp.innerText=u;let r=document.createElement("div"),b1=document.createElement("button");b1.innerText="🔍",b1.title="Sprawdź gdzie jest",b1.style.padding="3px 5px",b1.style.marginRight="5px",b1.style.cursor="pointer",b1.onclick=()=>{const connection=CHNS.connManager.connections[CHNS.activemaintabname];if(connection){connection.whereIsUser(u);}};let b2=document.createElement("button");b2.innerText="❌",b2.title="Usuń z listy znajomych",b2.style.padding="3px 5px",b2.style.cursor="pointer",b2.onclick=()=>{let newA=arr.filter(n=>n!==u);localStorage.czateria_znajomi=JSON.stringify(newA),handleFriendsPanel(true)};r.appendChild(b1),r.appendChild(b2),row.appendChild(sp),row.appendChild(r),dv.appendChild(row)});let addBtn=document.createElement("div");addBtn.style.cssText="margin-top:10px;";let addInp=document.createElement("input");addInp.type="text";addInp.placeholder="Dodaj nowego znajomego";addInp.style.cssText="width:150px;padding:3px;background:#333;border:1px solid #0f0;color:#fff;border-radius:3px;";let addSubmit=document.createElement("button");addSubmit.innerText="➕";addSubmit.style.cssText="margin-left:5px;padding:3px 8px;background:#333;border:1px solid #0f0;color:#0f0;border-radius:3px;cursor:pointer;";addSubmit.onclick=()=>{if(addInp.value.trim()){let currentList=JSON.parse(localStorage.czateria_znajomi||"[]");if(!currentList.includes(addInp.value.trim())){currentList.push(addInp.value.trim());localStorage.czateria_znajomi=JSON.stringify(currentList);handleFriendsPanel(true)}}};addBtn.appendChild(addInp);addBtn.appendChild(addSubmit);dv.appendChild(addBtn);document.body.appendChild(dv)}function handleContext(){let cm=document.querySelector(".context-menu");if(!cm)return;let head=cm.querySelector(".context-menu-item.context-menu-item--header");if(!head)return;let n=head.innerText||"",frs=new Set(JSON.parse(localStorage.czateria_znajomi||"[]")),has=frs.has(n);if(!cm.querySelector(".context-menu-item--friend")){let fItem=document.createElement("div");fItem.className="context-menu-item context-menu-item--friend",fItem.innerText=has?"🖕 Usuń z listy znajomych":"👋 Dodaj do znajomych",fItem.style.padding="5px 10px",fItem.onclick=()=>{has?frs.delete(n):frs.add(n),localStorage.czateria_znajomi=JSON.stringify([...frs]),cm.remove(),document.getElementById("friends-panel")&&handleFriendsPanel(true)},cm.appendChild(fItem)}cm.querySelector(".context-menu-item--wrongBehavior")?.remove();if(!cm.querySelector(".context-menu-item--locate")){let locateItem=document.createElement("div");locateItem.className="context-menu-item context-menu-item--locate";locateItem.innerText="🔍 Sprawdź lokalizację";locateItem.style.padding="5px 10px";locateItem.onclick=()=>{const connection=CHNS.connManager.connections[CHNS.activemaintabname];if(connection){connection.whereIsUser(n);}cm.remove()};cm.appendChild(locateItem)}let igItem=cm.querySelector(".context-menu-item--ignore"),igSet=new Set(JSON.parse(localStorage.czateria_ignorowani||"[]")),ig=igSet.has(n);igItem.innerText=ig?"✔%EF%B8%8F Przestań ignorowac":"❌ Ignoruj",igItem.onclick=()=>{ig?igSet.delete(n):igSet.add(n),localStorage.czateria_ignorowani=JSON.stringify([...igSet]),cm.remove()}}function main2(){try{removeGameOrdinary();document.getElementById("m-tab-main-container-1")&&(document.getElementById("m-tab-main-container-1").style.height="100%");let nav=document.getElementById("m-tab-main-container-1-nav");nav&&(nav.style.display="flex");let f=document.getElementById("friends");if(!f){f=document.createElement("input"),f.type="button",f.id="friends",f.value="Znajomi",f.className="button-send",f.style.height="25px",f.style.marginLeft="auto",f.style.padding="0 10px",f.style.background="#3a3a3a",f.style.color="white",f.style.border="1px solid #0f0",f.style.borderRadius="3px",f.style.cursor="pointer",nav.appendChild(f)}f.onclick=()=>{let p=document.getElementById("friends-panel");p?p.remove():handleFriendsPanel(false)};let contextObserver=new MutationObserver(muts=>{for(let mu of muts){if(mu.addedNodes.length){let nd=mu.addedNodes[0];if(nd.classList&&nd.classList.contains("context-menu")){handleContext();break}}}});contextObserver.observe(document.body,{childList:true,subtree:true});CHNS.channelManager&&(CHNS.channelManager.limit=e=>500);if(localStorage.czateria_ignorowani){let arr=JSON.parse(localStorage.czateria_ignorowani);arr.forEach(x=>{try{CHNS.listUsersOperations.addToIgnoredUserList(x.hashCode())}catch(e){}})}if(CHNS.viewManager){let oldNW=CHNS.viewManager.addNewWindow;CHNS.viewManager.addNewWindow=function(room,tab,opts){let ret=oldNW.apply(this,arguments);setTimeout(()=>{styleAllInputFields();let newContainers=document.querySelectorAll(".chat-container:not([style*='border'])");newContainers.forEach(c=>{c.style.border="2px solid #0f0";c.style.borderRadius="6px";c.style.padding="5px";c.style.boxShadow="0 0 10px rgba(0,255,0,0.3)";});let userLists=document.querySelectorAll(".m-roomAndPrivs-userList:not([style*='border'])");userLists.forEach(ul=>{ul.style.border="2px solid #0f0";ul.style.borderRadius="6px";ul.style.padding="5px";ul.style.boxShadow="0 0 10px rgba(0,255,0,0.3)";});},500);return ret}}}catch(e){console.log("Znajomi mod: main2 error:",e)}}main2()}catch(err){console.error("Błąd Skryptu znajomi/ignorowani:",err)}}function mainFunction(){let obs=new MutationObserver(mutations=>{for(let mutation of mutations){if(mutation.type==='childList'){let newGifs=false;let newInputs=false;let newContainers=false;for(let node of mutation.addedNodes){if(node.nodeType===1){if(node.querySelectorAll){if(node.querySelectorAll("img.img-gif").length>0||node.querySelectorAll("img.img-icon").length>0){newGifs=true}if(node.querySelectorAll("input.text-input").length>0){newInputs=true}if(node.classList&&node.classList.contains("chat-container")){newContainers=true}}}}if(newGifs){enableGifClick()}if(newInputs){styleAllInputFields();enhanceInputField()}if(newContainers){setTimeout(applyRoomFeatures,100)}}else if(mutation.type==='attributes'){if(mutation.target.classList&&mutation.target.classList.contains("text-input")){styleAllInputFields();enhanceInputField()}}}});obs.observe(document.body,{childList:true,subtree:true,attributes:true,attributeFilter:['style','class']});let hd=document.getElementById("mainHeader");hd&&hd.remove();let container=document.getElementById("m-tab-main-container-1");container&&(container.style.height="100%");let gm=document.querySelector(".m-game.js-play-game");gm&&gm.remove();["contextmenu","copy","paste"].forEach(evt=>{if(window["on"+evt])window.addEventListener(evt,e=>{e.stopPropagation()},true)});let floatb=document.querySelector(".floatbox-box-background");floatb&&(floatb.style.background="#2c2c2c"),initUI(),applyRoomFeatures(),fixDelationAccess();setupFriendsAndIgnoreList();window.messageObserver=setupMessageObserver();highlightMyNick();if(CHNS.viewManager){let oldAddWin=CHNS.viewManager.addNewWindow;CHNS.viewManager.addNewWindow=function(){let result=oldAddWin.apply(this,arguments);setTimeout(function(){styleAllInputFields();enhanceInputField();applyRoomFeatures();highlightMyNick();},300);return result};}setInterval(function(){if(highlightedMessages.size>1000){const arr=Array.from(highlightedMessages);highlightedMessages=new Set(arr.slice(arr.length-200));console.log("Wyczyszczono pamięć podświetleń, pozostało: "+highlightedMessages.size);}},15*60*1000);return true}mainFunction();unblockCaptcha();fixBlockedFunctions();forcePrivateMessageEnabling();highlightMyNick();testSound(nickSoundUrl);if(document.getElementById("swirModMatrix"))document.getElementById("swirModMatrix").remove();alert("✅ CZATERIA MOD 6.7 ULTIMATE uruchomiony!\n\n• Nowa funkcja: Wymuszanie wiadomości prywatnych (/forcepriv)\n• Komendy: /nospam, /unlock, /admin, /forcepriv, /status\n• Całkowicie przepisany moduł wiadomości prywatnych\n• Możesz wyłączyć AntySpam i odblokować funkcje kiedy chcesz\n• Wszystko kontrolujesz przez panel MOD i komendy\n\nKliknij przycisk MOD u góry, aby otworzyć panel konfiguracyjny");}catch(e){alert("❌ Błąd: "+e);console.error("Main script error:",e)}})();
